{"remainingRequest":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/thread-loader/dist/cjs.js!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/babel-loader/lib/index.js!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/ts-loader/index.js??ref--15-3!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/pages/Heightmap.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/pages/Heightmap.vue","mtime":1644874918000},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/thread-loader/dist/cjs.js","mtime":1645990064416},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/babel-loader/lib/index.js","mtime":1645990067759},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/ts-loader/index.js","mtime":1645990068168},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1645990069130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvVXNlcnMvYW5uZS1zb3BoaWVyb3kvRG93bmxvYWRzL01haW5zYWlsL21haW5zYWlsLW1haW50ZW5hbmNlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICIvVXNlcnMvYW5uZS1zb3BoaWVyb3kvRG93bmxvYWRzL01haW5zYWlsL21haW5zYWlsLW1haW50ZW5hbmNlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5LmpzIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy9hbm5lLXNvcGhpZXJveS9Eb3dubG9hZHMvTWFpbnNhaWwvbWFpbnNhaWwtbWFpbnRlbmFuY2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy9hbm5lLXNvcGhpZXJveS9Eb3dubG9hZHMvTWFpbnNhaWwvbWFpbnNhaWwtbWFpbnRlbmFuY2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrLmpzIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMvYW5uZS1zb3BoaWVyb3kvRG93bmxvYWRzL01haW5zYWlsL21haW5zYWlsLW1haW50ZW5hbmNlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcy5qcyI7CmltcG9ydCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkIGZyb20gIi9Vc2Vycy9hbm5lLXNvcGhpZXJveS9Eb3dubG9hZHMvTWFpbnNhaWwvbWFpbnNhaWwtbWFpbnRlbmFuY2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2Fzc2VydFRoaXNJbml0aWFsaXplZC5qcyI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiL1VzZXJzL2FubmUtc29waGllcm95L0Rvd25sb2Fkcy9NYWluc2FpbC9tYWluc2FpbC1tYWludGVuYW5jZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMuanMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIi9Vc2Vycy9hbm5lLXNvcGhpZXJveS9Eb3dubG9hZHMvTWFpbnNhaWwvbWFpbnNhaWwtbWFpbnRlbmFuY2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyLmpzIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvVXNlcnMvYW5uZS1zb3BoaWVyb3kvRG93bmxvYWRzL01haW5zYWlsL21haW5zYWlsLW1haW50ZW5hbmNlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci50by1maXhlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZsYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS51bnNjb3BhYmxlcy5mbGF0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0IHsgX19kZWNvcmF0ZSB9IGZyb20gInRzbGliIjsKaW1wb3J0IHsgQ29tcG9uZW50LCBNaXhpbnMsIFdhdGNoIH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcic7CmltcG9ydCBCYXNlTWl4aW4gZnJvbSAnQC9jb21wb25lbnRzL21peGlucy9iYXNlJzsKaW1wb3J0IENvbnRyb2xNaXhpbiBmcm9tICdAL2NvbXBvbmVudHMvbWl4aW5zL2NvbnRyb2wnOwppbXBvcnQgeyBjcmVhdGVDb21wb25lbnQgfSBmcm9tICdlY2hhcnRzLWZvci12dWUnOwppbXBvcnQgKiBhcyBlY2hhcnRzIGZyb20gJ2VjaGFydHMnOwppbXBvcnQgJ2VjaGFydHMtZ2wnOwppbXBvcnQgUGFuZWwgZnJvbSAnQC9jb21wb25lbnRzL3VpL1BhbmVsLnZ1ZSc7Cgp2YXIgUGFnZUhlaWdodG1hcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX01peGlucykgewogIF9pbmhlcml0cyhQYWdlSGVpZ2h0bWFwLCBfTWl4aW5zKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihQYWdlSGVpZ2h0bWFwKTsKCiAgZnVuY3Rpb24gUGFnZUhlaWdodG1hcCgpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGFnZUhlaWdodG1hcCk7CgogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICB9CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbC5hcHBseShfc3VwZXIsIFt0aGlzXS5jb25jYXQoYXJncykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIiRyZWZzIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW5hbWVEaWFsb2ciLCBmYWxzZSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVtb3ZlRGlhbG9nUHJvZmlsZSIsICcnKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW1vdmVEaWFsb2ciLCBmYWxzZSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2FsaWJyYXRlRGlhbG9nIiwgZmFsc2UpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm5ld05hbWUiLCAnJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib2xkTmFtZSIsICcnKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoZWlnaHRtYXBTY2FsZSIsIDAuNSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicHJvYmVkT3BhY2l0eSIsIDEpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm1lc2hPcGFjaXR5IiwgMSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmxhdE9wYWNpdHkiLCAwLjUpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNvbG9yQXhpc05hbWUiLCAncmdiYSgyNTUsMjU1LDI1NSwwLjUpJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY29sb3JBeGlzTGFiZWwiLCAncmdiYSgyNTUsMjU1LDI1NSwwLjUpJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY29sb3JBeGlzTGluZSIsICdyZ2JhKDI1NSwyNTUsMjU1LDAuMiknKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjb2xvckF4aXNUaWNrIiwgJ3JnYmEoMjU1LDI1NSwyNTUsMC4yKScpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNvbG9yU3BsaXRMaW5lIiwgJ3JnYmEoMjU1LDI1NSwyNTUsMC4yKScpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNvbG9yQXhpc1BvaW50ZXIiLCAncmdiYSgyNTUsMjU1LDI1NSwwLjgpJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY29sb3JWaXN1YWxNYXAiLCAncmdiYSgyNTUsMjU1LDI1NSwwLjgpJyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZm9udFNpemVWaXN1YWxNYXAiLCAxNCk7CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFBhZ2VIZWlnaHRtYXAsIFt7CiAgICBrZXk6ICJjaGFydE9wdGlvbnMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdG9vbHRpcDogewogICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgwLDAsMCwwLjkpJywKICAgICAgICAgIGJvcmRlcldpZHRoOiAwLAogICAgICAgICAgdGV4dFN0eWxlOiB7CiAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsCiAgICAgICAgICAgIGZvbnRTaXplOiAnMTRweCcKICAgICAgICAgIH0sCiAgICAgICAgICBwYWRkaW5nOiAxNSwKICAgICAgICAgIGZvcm1hdHRlcjogdGhpcy50b29sdGlwRm9ybWF0dGVyCiAgICAgICAgfSwKICAgICAgICBkYXJrTW9kZTogdHJ1ZSwKICAgICAgICBhbmltYXRpb246IGZhbHNlLAogICAgICAgIGxlZ2VuZDogewogICAgICAgICAgc2hvdzogZmFsc2UsCiAgICAgICAgICBzZWxlY3RlZDogdGhpcy5zZWxlY3RlZAogICAgICAgIH0sCiAgICAgICAgdmlzdWFsTWFwOiB7CiAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgbWluOiB0aGlzLnZpc3VhbE1hcFJhbmdlWzBdLAogICAgICAgICAgbWF4OiB0aGlzLnZpc3VhbE1hcFJhbmdlWzFdLAogICAgICAgICAgY2FsY3VsYWJsZTogdHJ1ZSwKICAgICAgICAgIGRpbWVuc2lvbjogMiwKICAgICAgICAgIGluUmFuZ2U6IHsKICAgICAgICAgICAgY29sb3I6IFsnIzMxMzY5NScsICcjNDU3NWI0JywgJyM3NGFkZDEnLCAnI2FiZDllOScsICcjZTBmM2Y4JywgJyNmZmZmYmYnLCAnI2ZlZTA5MCcsICcjZmRhZTYxJywgJyNmNDZkNDMnLCAnI2Q3MzAyNycsICcjYTUwMDI2J10KICAgICAgICAgIH0sCiAgICAgICAgICBzZXJpZXNJbmRleDogdGhpcy52aXN1YWxNYXBTZXJpZXNJbmRleCwKICAgICAgICAgIGxlZnQ6IHRoaXMuaXNNb2JpbGUgPyAxMCA6IDMwLAogICAgICAgICAgdG9wOiAyMCwKICAgICAgICAgIGJvdHRvbTogMCwKICAgICAgICAgIGl0ZW1XaWR0aDogdGhpcy5pc01vYmlsZSA/IDEwIDogMzAsCiAgICAgICAgICBpdGVtSGVpZ2h0OiAzNTAsCiAgICAgICAgICBwcmVjaXNpb246IDMsCiAgICAgICAgICB0ZXh0U3R5bGU6IHsKICAgICAgICAgICAgY29sb3I6IHRoaXMuY29sb3JWaXN1YWxNYXAsCiAgICAgICAgICAgIGZvbnRTaXplOiB0aGlzLmZvbnRTaXplVmlzdWFsTWFwCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB4QXhpczNEOiB7CiAgICAgICAgICB0eXBlOiAndmFsdWUnLAogICAgICAgICAgbmFtZVRleHRTdHlsZTogewogICAgICAgICAgICBjb2xvcjogdGhpcy5jb2xvckF4aXNOYW1lCiAgICAgICAgICB9LAogICAgICAgICAgbWluOiB0aGlzLnJhbmdlWFswXSwKICAgICAgICAgIG1heDogdGhpcy5yYW5nZVhbMV0sCiAgICAgICAgICBtaW5JbnRlcnZhbDogMQogICAgICAgIH0sCiAgICAgICAgeUF4aXMzRDogewogICAgICAgICAgdHlwZTogJ3ZhbHVlJywKICAgICAgICAgIG5hbWVUZXh0U3R5bGU6IHsKICAgICAgICAgICAgY29sb3I6IHRoaXMuY29sb3JBeGlzTmFtZQogICAgICAgICAgfSwKICAgICAgICAgIG1pbjogdGhpcy5yYW5nZVlbMF0sCiAgICAgICAgICBtYXg6IHRoaXMucmFuZ2VZWzFdCiAgICAgICAgfSwKICAgICAgICB6QXhpczNEOiB7CiAgICAgICAgICB0eXBlOiAndmFsdWUnLAogICAgICAgICAgbWluOiB0aGlzLmhlaWdodG1hcFNjYWxlICogLTEsCiAgICAgICAgICBtYXg6IHRoaXMuaGVpZ2h0bWFwU2NhbGUsCiAgICAgICAgICBuYW1lVGV4dFN0eWxlOiB7CiAgICAgICAgICAgIGNvbG9yOiB0aGlzLmNvbG9yQXhpc05hbWUKICAgICAgICAgIH0sCiAgICAgICAgICBheGlzUG9pbnRlcjogewogICAgICAgICAgICBsYWJlbDogewogICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24gZm9ybWF0dGVyKHZhbHVlKSB7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvRml4ZWQoMik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBncmlkM0Q6IHsKICAgICAgICAgIGF4aXNMYWJlbDogewogICAgICAgICAgICB0ZXh0U3R5bGU6IHsKICAgICAgICAgICAgICBjb2xvcjogdGhpcy5jb2xvckF4aXNMYWJlbAogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgYXhpc0xpbmU6IHsKICAgICAgICAgICAgbGluZVN0eWxlOiB7CiAgICAgICAgICAgICAgY29sb3I6IHRoaXMuY29sb3JBeGlzTGluZQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgYXhpc1RpY2s6IHsKICAgICAgICAgICAgbGluZVN0eWxlOiB7CiAgICAgICAgICAgICAgY29sb3I6IHRoaXMuY29sb3JBeGlzVGljawogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgc3BsaXRMaW5lOiB7CiAgICAgICAgICAgIGxpbmVTdHlsZTogewogICAgICAgICAgICAgIGNvbG9yOiB0aGlzLmNvbG9yU3BsaXRMaW5lCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICBheGlzUG9pbnRlcjogewogICAgICAgICAgICBsaW5lU3R5bGU6IHsKICAgICAgICAgICAgICBjb2xvcjogdGhpcy5jb2xvckF4aXNQb2ludGVyCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxhYmVsOiB7CiAgICAgICAgICAgICAgdGV4dFN0eWxlOiB7CiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5jb2xvckF4aXNQb2ludGVyCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzZXJpZXM6IHRoaXMuc2VyaWVzCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiY2hhcnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfaGVpZ2h0bWFwJGluc3Q7CgogICAgICB2YXIgaGVpZ2h0bWFwID0gdGhpcy4kcmVmcy5oZWlnaHRtYXA7CiAgICAgIHJldHVybiAoX2hlaWdodG1hcCRpbnN0ID0gaGVpZ2h0bWFwID09PSBudWxsIHx8IGhlaWdodG1hcCA9PT0gdm9pZCAwID8gdm9pZCAwIDogaGVpZ2h0bWFwLmluc3QpICE9PSBudWxsICYmIF9oZWlnaHRtYXAkaW5zdCAhPT0gdm9pZCAwID8gX2hlaWdodG1hcCRpbnN0IDogbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwcm9maWxlcyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ3ByaW50ZXIvZ2V0QmVkTWVzaFByb2ZpbGVzJ107CiAgICB9CiAgfSwgewogICAga2V5OiAiYmVkX21lc2giLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyQkc3RvcmUkc3RhdGUkcHI7CgogICAgICByZXR1cm4gKF90aGlzJCRzdG9yZSRzdGF0ZSRwciA9IHRoaXMuJHN0b3JlLnN0YXRlLnByaW50ZXIuYmVkX21lc2gpICE9PSBudWxsICYmIF90aGlzJCRzdG9yZSRzdGF0ZSRwciAhPT0gdm9pZCAwID8gX3RoaXMkJHN0b3JlJHN0YXRlJHByIDogbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJiZWRfbWVzaENoYW5nZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJlZF9tZXNoQ2hhbmdlZCgpIHsKICAgICAgdmFyIF90aGlzJGNoYXJ0OwoKICAgICAgKF90aGlzJGNoYXJ0ID0gdGhpcy5jaGFydCkgPT09IG51bGwgfHwgX3RoaXMkY2hhcnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGNoYXJ0LnNldE9wdGlvbih0aGlzLmNoYXJ0T3B0aW9ucyk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2hvd1Byb2JlZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJCRzdG9yZSRzdGF0ZSRndTsKCiAgICAgIHJldHVybiAoX3RoaXMkJHN0b3JlJHN0YXRlJGd1ID0gdGhpcy4kc3RvcmUuc3RhdGUuZ3VpLnZpZXcuaGVpZ2h0bWFwLnByb2JlZCkgIT09IG51bGwgJiYgX3RoaXMkJHN0b3JlJHN0YXRlJGd1ICE9PSB2b2lkIDAgPyBfdGhpcyQkc3RvcmUkc3RhdGUkZ3UgOiB0cnVlOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KG5ld1ZhbCkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3VpL3NhdmVTZXR0aW5nJywgewogICAgICAgIG5hbWU6ICd2aWV3LmhlaWdodG1hcC5wcm9iZWQnLAogICAgICAgIHZhbHVlOiBuZXdWYWwKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2hvd01lc2giLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyQkc3RvcmUkc3RhdGUkZ3UyOwoKICAgICAgcmV0dXJuIChfdGhpcyQkc3RvcmUkc3RhdGUkZ3UyID0gdGhpcy4kc3RvcmUuc3RhdGUuZ3VpLnZpZXcuaGVpZ2h0bWFwLm1lc2gpICE9PSBudWxsICYmIF90aGlzJCRzdG9yZSRzdGF0ZSRndTIgIT09IHZvaWQgMCA/IF90aGlzJCRzdG9yZSRzdGF0ZSRndTIgOiB0cnVlOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KG5ld1ZhbCkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3VpL3NhdmVTZXR0aW5nJywgewogICAgICAgIG5hbWU6ICd2aWV3LmhlaWdodG1hcC5tZXNoJywKICAgICAgICB2YWx1ZTogbmV3VmFsCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInNob3dGbGF0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkJHN0b3JlJHN0YXRlJGd1MzsKCiAgICAgIHJldHVybiAoX3RoaXMkJHN0b3JlJHN0YXRlJGd1MyA9IHRoaXMuJHN0b3JlLnN0YXRlLmd1aS52aWV3LmhlaWdodG1hcC5mbGF0KSAhPT0gbnVsbCAmJiBfdGhpcyQkc3RvcmUkc3RhdGUkZ3UzICE9PSB2b2lkIDAgPyBfdGhpcyQkc3RvcmUkc3RhdGUkZ3UzIDogdHJ1ZTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChuZXdWYWwpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2d1aS9zYXZlU2V0dGluZycsIHsKICAgICAgICBuYW1lOiAndmlldy5oZWlnaHRtYXAuZmxhdCcsCiAgICAgICAgdmFsdWU6IG5ld1ZhbAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ3aXJlZnJhbWUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyQkc3RvcmUkc3RhdGUkZ3U0OwoKICAgICAgcmV0dXJuIChfdGhpcyQkc3RvcmUkc3RhdGUkZ3U0ID0gdGhpcy4kc3RvcmUuc3RhdGUuZ3VpLnZpZXcuaGVpZ2h0bWFwLndpcmVmcmFtZSkgIT09IG51bGwgJiYgX3RoaXMkJHN0b3JlJHN0YXRlJGd1NCAhPT0gdm9pZCAwID8gX3RoaXMkJHN0b3JlJHN0YXRlJGd1NCA6IHRydWU7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiBzZXQobmV3VmFsKSB7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdndWkvc2F2ZVNldHRpbmcnLCB7CiAgICAgICAgbmFtZTogJ3ZpZXcuaGVpZ2h0bWFwLndpcmVmcmFtZScsCiAgICAgICAgdmFsdWU6IG5ld1ZhbAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzY2FsZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJCRzdG9yZSRzdGF0ZSRndTU7CgogICAgICByZXR1cm4gKF90aGlzJCRzdG9yZSRzdGF0ZSRndTUgPSB0aGlzLiRzdG9yZS5zdGF0ZS5ndWkudmlldy5oZWlnaHRtYXAuc2NhbGUpICE9PSBudWxsICYmIF90aGlzJCRzdG9yZSRzdGF0ZSRndTUgIT09IHZvaWQgMCA/IF90aGlzJCRzdG9yZSRzdGF0ZSRndTUgOiB0cnVlOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KG5ld1ZhbCkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3VpL3NhdmVTZXR0aW5nJywgewogICAgICAgIG5hbWU6ICd2aWV3LmhlaWdodG1hcC5zY2FsZScsCiAgICAgICAgdmFsdWU6IG5ld1ZhbAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzY2FsZVZpc3VhbE1hcCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJCRzdG9yZSRzdGF0ZSRndTY7CgogICAgICByZXR1cm4gKF90aGlzJCRzdG9yZSRzdGF0ZSRndTYgPSB0aGlzLiRzdG9yZS5zdGF0ZS5ndWkudmlldy5oZWlnaHRtYXAuc2NhbGVWaXN1YWxNYXApICE9PSBudWxsICYmIF90aGlzJCRzdG9yZSRzdGF0ZSRndTYgIT09IHZvaWQgMCA/IF90aGlzJCRzdG9yZSRzdGF0ZSRndTYgOiBmYWxzZTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChuZXdWYWwpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2d1aS9zYXZlU2V0dGluZycsIHsKICAgICAgICBuYW1lOiAndmlldy5oZWlnaHRtYXAuc2NhbGVWaXN1YWxNYXAnLAogICAgICAgIHZhbHVlOiBuZXdWYWwKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmFuZ2VYIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkJHN0b3JlJHN0YXRlJHByMiwgX3RoaXMkJHN0b3JlJHN0YXRlJHByMywgX2F4aXNfbWluaW11bSQsIF9heGlzX21heGltdW0kOwoKICAgICAgdmFyIGF4aXNfbWluaW11bSA9IChfdGhpcyQkc3RvcmUkc3RhdGUkcHIyID0gdGhpcy4kc3RvcmUuc3RhdGUucHJpbnRlci50b29saGVhZCkgPT09IG51bGwgfHwgX3RoaXMkJHN0b3JlJHN0YXRlJHByMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkJHN0b3JlJHN0YXRlJHByMi5heGlzX21pbmltdW07CiAgICAgIHZhciBheGlzX21heGltdW0gPSAoX3RoaXMkJHN0b3JlJHN0YXRlJHByMyA9IHRoaXMuJHN0b3JlLnN0YXRlLnByaW50ZXIudG9vbGhlYWQpID09PSBudWxsIHx8IF90aGlzJCRzdG9yZSRzdGF0ZSRwcjMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJCRzdG9yZSRzdGF0ZSRwcjMuYXhpc19tYXhpbXVtOwogICAgICByZXR1cm4gWyhfYXhpc19taW5pbXVtJCA9IGF4aXNfbWluaW11bVswXSkgIT09IG51bGwgJiYgX2F4aXNfbWluaW11bSQgIT09IHZvaWQgMCA/IF9heGlzX21pbmltdW0kIDogMCwgKF9heGlzX21heGltdW0kID0gYXhpc19tYXhpbXVtWzBdKSAhPT0gbnVsbCAmJiBfYXhpc19tYXhpbXVtJCAhPT0gdm9pZCAwID8gX2F4aXNfbWF4aW11bSQgOiAwXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyYW5nZVkiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyQkc3RvcmUkc3RhdGUkcHI0LCBfdGhpcyQkc3RvcmUkc3RhdGUkcHI1LCBfdGhpcyQkc3RvcmUkc3RhdGUkcHI2LCBfdGhpcyQkc3RvcmUkc3RhdGUkcHI3LCBfYXhpc19taW5pbXVtJDIsIF9heGlzX21heGltdW0kMjsKCiAgICAgIHZhciBheGlzX21pbmltdW0gPSAoX3RoaXMkJHN0b3JlJHN0YXRlJHByNCA9IChfdGhpcyQkc3RvcmUkc3RhdGUkcHI1ID0gdGhpcy4kc3RvcmUuc3RhdGUucHJpbnRlci50b29saGVhZCkgPT09IG51bGwgfHwgX3RoaXMkJHN0b3JlJHN0YXRlJHByNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkJHN0b3JlJHN0YXRlJHByNS5heGlzX21pbmltdW0pICE9PSBudWxsICYmIF90aGlzJCRzdG9yZSRzdGF0ZSRwcjQgIT09IHZvaWQgMCA/IF90aGlzJCRzdG9yZSRzdGF0ZSRwcjQgOiBbMCwgMF07CiAgICAgIHZhciBheGlzX21heGltdW0gPSAoX3RoaXMkJHN0b3JlJHN0YXRlJHByNiA9IChfdGhpcyQkc3RvcmUkc3RhdGUkcHI3ID0gdGhpcy4kc3RvcmUuc3RhdGUucHJpbnRlci50b29saGVhZCkgPT09IG51bGwgfHwgX3RoaXMkJHN0b3JlJHN0YXRlJHByNyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkJHN0b3JlJHN0YXRlJHByNy5heGlzX21heGltdW0pICE9PSBudWxsICYmIF90aGlzJCRzdG9yZSRzdGF0ZSRwcjYgIT09IHZvaWQgMCA/IF90aGlzJCRzdG9yZSRzdGF0ZSRwcjYgOiBbMCwgMF07CiAgICAgIHJldHVybiBbKF9heGlzX21pbmltdW0kMiA9IGF4aXNfbWluaW11bVsxXSkgIT09IG51bGwgJiYgX2F4aXNfbWluaW11bSQyICE9PSB2b2lkIDAgPyBfYXhpc19taW5pbXVtJDIgOiAwLCAoX2F4aXNfbWF4aW11bSQyID0gYXhpc19tYXhpbXVtWzFdKSAhPT0gbnVsbCAmJiBfYXhpc19tYXhpbXVtJDIgIT09IHZvaWQgMCA/IF9heGlzX21heGltdW0kMiA6IDBdOwogICAgfQogIH0sIHsKICAgIGtleTogImhlaWdodG1hcExpbWl0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgbWluID0gMDsKICAgICAgdmFyIG1heCA9IDA7CgogICAgICBpZiAodGhpcy5iZWRfbWVzaCkgewogICAgICAgIHZhciBwb2ludHMgPSBbXTsKCiAgICAgICAgaWYgKHRoaXMuc2hvd1Byb2JlZCkgewogICAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuYmVkX21lc2gucHJvYmVkX21hdHJpeCksCiAgICAgICAgICAgICAgX3N0ZXA7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICB2YXIgcm93ID0gX3N0ZXAudmFsdWU7CgogICAgICAgICAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocm93KSwKICAgICAgICAgICAgICAgICAgX3N0ZXAyOwoKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY29sKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnNob3dNZXNoKSB7CiAgICAgICAgICB2YXIgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuYmVkX21lc2gubWVzaF9tYXRyaXgpLAogICAgICAgICAgICAgIF9zdGVwMzsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciBfcm93ID0gX3N0ZXAzLnZhbHVlOwoKICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yNCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKF9yb3cpLAogICAgICAgICAgICAgICAgICBfc3RlcDQ7CgogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgICB2YXIgX2NvbCA9IF9zdGVwNC52YWx1ZTsKICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goX2NvbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgX2l0ZXJhdG9yNC5mKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgX2l0ZXJhdG9yMy5lKGVycik7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfaXRlcmF0b3IzLmYoKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG1pbiA9IE1hdGgubWluLmFwcGx5KE1hdGgsIFttaW5dLmNvbmNhdChwb2ludHMpKTsKICAgICAgICBtYXggPSBNYXRoLm1heC5hcHBseShNYXRoLCBbbWF4XS5jb25jYXQocG9pbnRzKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBbbWluLCBtYXhdOwogICAgfQogIH0sIHsKICAgIGtleTogInByb2JlZEhlaWdodG1hcExpbWl0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgbWluID0gMDsKICAgICAgdmFyIG1heCA9IDA7CgogICAgICBpZiAodGhpcy5iZWRfbWVzaCkgewogICAgICAgIHZhciBwb2ludHMgPSBbXTsKCiAgICAgICAgdmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmJlZF9tZXNoLnByb2JlZF9tYXRyaXgpLAogICAgICAgICAgICBfc3RlcDU7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgcm93ID0gX3N0ZXA1LnZhbHVlOwoKICAgICAgICAgICAgdmFyIF9pdGVyYXRvcjYgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyb3cpLAogICAgICAgICAgICAgICAgX3N0ZXA2OwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjYucygpOyAhKF9zdGVwNiA9IF9pdGVyYXRvcjYubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9zdGVwNi52YWx1ZTsKICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNvbCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICBfaXRlcmF0b3I2LmUoZXJyKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICBfaXRlcmF0b3I2LmYoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yNS5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjUuZigpOwogICAgICAgIH0KCiAgICAgICAgbWluID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgW21pbl0uY29uY2F0KHBvaW50cykpOwogICAgICAgIG1heCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIFttYXhdLmNvbmNhdChwb2ludHMpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFttaW4sIG1heF07CiAgICB9CiAgfSwgewogICAga2V5OiAiaGVpZ2h0bWFwUmFuZ2VMaW1pdCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJGhlaWdodG1hcExpbWl0ID0gX3NsaWNlZFRvQXJyYXkodGhpcy5oZWlnaHRtYXBMaW1pdCwgMiksCiAgICAgICAgICBtaW4gPSBfdGhpcyRoZWlnaHRtYXBMaW1pdFswXSwKICAgICAgICAgIG1heCA9IF90aGlzJGhlaWdodG1hcExpbWl0WzFdOwoKICAgICAgdmFyIG1pblJhbmdlID0gTWF0aC5yb3VuZChNYXRoLm1heChNYXRoLmFicyhtaW4pLCBNYXRoLmFicyhtYXgpKSAqIDEwKSAvIDEwOwogICAgICB2YXIgbWF4UmFuZ2UgPSBNYXRoLm1heChtaW5SYW5nZSwgMC41KTsKICAgICAgcmV0dXJuIFttaW5SYW5nZSwgbWF4UmFuZ2VdOwogICAgfQogIH0sIHsKICAgIGtleTogInNlbGVjdGVkIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gewogICAgICAgICdwcm9iZWQnOiB0aGlzLnNob3dQcm9iZWQsCiAgICAgICAgJ21lc2gnOiB0aGlzLnNob3dNZXNoLAogICAgICAgICdmbGF0JzogdGhpcy5zaG93RmxhdAogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInNlcmllcyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHNlcmllcyA9IFtdOwoKICAgICAgaWYgKHRoaXMuYmVkX21lc2gpIHsKICAgICAgICBzZXJpZXMucHVzaCh0aGlzLnNlcmllc1Byb2JlZCk7CiAgICAgICAgc2VyaWVzLnB1c2godGhpcy5zZXJpZXNNZXNoKTsKICAgICAgICBzZXJpZXMucHVzaCh0aGlzLnNlcmllc0ZsYXQpOwogICAgICB9CgogICAgICByZXR1cm4gc2VyaWVzOwogICAgfQogIH0sIHsKICAgIGtleTogInNlcmllc1Byb2JlZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHNlcmllID0gewogICAgICAgIHR5cGU6ICdzdXJmYWNlJywKICAgICAgICBuYW1lOiAncHJvYmVkJywKICAgICAgICBkYXRhOiBbXSwKICAgICAgICBpdGVtU3R5bGU6IHsKICAgICAgICAgIG9wYWNpdHk6IHRoaXMucHJvYmVkT3BhY2l0eQogICAgICAgIH0sCiAgICAgICAgd2lyZWZyYW1lOiB7CiAgICAgICAgICBzaG93OiB0aGlzLndpcmVmcmFtZQogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmICh0aGlzLmJlZF9tZXNoKSB7CiAgICAgICAgdmFyIHhDb3VudCA9IHRoaXMuYmVkX21lc2gucHJvYmVkX21hdHJpeFswXS5sZW5ndGg7CiAgICAgICAgdmFyIHlDb3VudCA9IHRoaXMuYmVkX21lc2gucHJvYmVkX21hdHJpeC5sZW5ndGg7CiAgICAgICAgdmFyIHhNaW4gPSB0aGlzLmJlZF9tZXNoLm1lc2hfbWluWzBdOwogICAgICAgIHZhciB4TWF4ID0gdGhpcy5iZWRfbWVzaC5tZXNoX21heFswXTsKICAgICAgICB2YXIgeU1pbiA9IHRoaXMuYmVkX21lc2gubWVzaF9taW5bMV07CiAgICAgICAgdmFyIHlNYXggPSB0aGlzLmJlZF9tZXNoLm1lc2hfbWF4WzFdOwogICAgICAgIHZhciB4U3RlcCA9ICh4TWF4IC0geE1pbikgLyAoeENvdW50IC0gMSk7CiAgICAgICAgdmFyIHlTdGVwID0gKHlNYXggLSB5TWluKSAvICh5Q291bnQgLSAxKTsKICAgICAgICB2YXIgZGF0YSA9IFtdOwogICAgICAgIHZhciB5UG9pbnQgPSAwOwogICAgICAgIHRoaXMuYmVkX21lc2gucHJvYmVkX21hdHJpeC5mb3JFYWNoKGZ1bmN0aW9uIChtZXNoUm93KSB7CiAgICAgICAgICB2YXIgeFBvaW50ID0gMDsKICAgICAgICAgIG1lc2hSb3cuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgZGF0YS5wdXNoKFt4TWluICsgeFN0ZXAgKiB4UG9pbnQsIHlNaW4gKyB5U3RlcCAqIHlQb2ludCwgdmFsdWVdKTsKICAgICAgICAgICAgeFBvaW50Kys7CiAgICAgICAgICB9KTsKICAgICAgICAgIHlQb2ludCsrOwogICAgICAgIH0pOwogICAgICAgIHNlcmllLmRhdGEgPSBkYXRhOwogICAgICAgIHNlcmllLmRhdGFTaGFwZSA9IFt5Q291bnQsIHhDb3VudF07CiAgICAgIH0KCiAgICAgIHJldHVybiBzZXJpZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXJpZXNNZXNoIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgc2VyaWUgPSB7CiAgICAgICAgdHlwZTogJ3N1cmZhY2UnLAogICAgICAgIG5hbWU6ICdtZXNoJywKICAgICAgICBkYXRhOiBbXSwKICAgICAgICBpdGVtU3R5bGU6IHsKICAgICAgICAgIG9wYWNpdHk6IHRoaXMubWVzaE9wYWNpdHkKICAgICAgICB9LAogICAgICAgIHdpcmVmcmFtZTogewogICAgICAgICAgc2hvdzogdGhpcy53aXJlZnJhbWUKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAodGhpcy5iZWRfbWVzaCkgewogICAgICAgIHZhciB4Q291bnQgPSB0aGlzLmJlZF9tZXNoLm1lc2hfbWF0cml4WzBdLmxlbmd0aDsKICAgICAgICB2YXIgeUNvdW50ID0gdGhpcy5iZWRfbWVzaC5tZXNoX21hdHJpeC5sZW5ndGg7CiAgICAgICAgdmFyIHhNaW4gPSB0aGlzLmJlZF9tZXNoLm1lc2hfbWluWzBdOwogICAgICAgIHZhciB4TWF4ID0gdGhpcy5iZWRfbWVzaC5tZXNoX21heFswXTsKICAgICAgICB2YXIgeU1pbiA9IHRoaXMuYmVkX21lc2gubWVzaF9taW5bMV07CiAgICAgICAgdmFyIHlNYXggPSB0aGlzLmJlZF9tZXNoLm1lc2hfbWF4WzFdOwogICAgICAgIHZhciB4U3RlcCA9ICh4TWF4IC0geE1pbikgLyAoeENvdW50IC0gMSk7CiAgICAgICAgdmFyIHlTdGVwID0gKHlNYXggLSB5TWluKSAvICh5Q291bnQgLSAxKTsKICAgICAgICB2YXIgZGF0YSA9IFtdOwogICAgICAgIHZhciB5UG9pbnQgPSAwOwogICAgICAgIHRoaXMuYmVkX21lc2gubWVzaF9tYXRyaXguZm9yRWFjaChmdW5jdGlvbiAobWVzaFJvdykgewogICAgICAgICAgdmFyIHhQb2ludCA9IDA7CiAgICAgICAgICBtZXNoUm93LmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgIGRhdGEucHVzaChbeE1pbiArIHhTdGVwICogeFBvaW50LCB5TWluICsgeVN0ZXAgKiB5UG9pbnQsIHZhbHVlXSk7CiAgICAgICAgICAgIHhQb2ludCsrOwogICAgICAgICAgfSk7CiAgICAgICAgICB5UG9pbnQrKzsKICAgICAgICB9KTsKICAgICAgICBzZXJpZS5kYXRhID0gZGF0YTsKICAgICAgICBzZXJpZS5kYXRhU2hhcGUgPSBbeUNvdW50LCB4Q291bnRdOwogICAgICB9CgogICAgICByZXR1cm4gc2VyaWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2VyaWVzRmxhdCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJCRzdG9yZSRzdGF0ZSRwcjgsIF90aGlzJCRzdG9yZSRzdGF0ZSRwcjk7CgogICAgICB2YXIgc2VyaWUgPSB7CiAgICAgICAgdHlwZTogJ3N1cmZhY2UnLAogICAgICAgIG5hbWU6ICdmbGF0JywKICAgICAgICBkYXRhOiBbXSwKICAgICAgICBpdGVtU3R5bGU6IHsKICAgICAgICAgIGNvbG9yOiBbMSwgMSwgMSwgMV0sCiAgICAgICAgICBvcGFjaXR5OiB0aGlzLmZsYXRPcGFjaXR5CiAgICAgICAgfSwKICAgICAgICB3aXJlZnJhbWU6IHsKICAgICAgICAgIHNob3c6IHRoaXMud2lyZWZyYW1lCiAgICAgICAgfQogICAgICB9OwogICAgICB2YXIgY29uZmlnID0gKF90aGlzJCRzdG9yZSRzdGF0ZSRwcjggPSB0aGlzLiRzdG9yZS5zdGF0ZS5wcmludGVyLmNvbmZpZ2ZpbGUpID09PSBudWxsIHx8IF90aGlzJCRzdG9yZSRzdGF0ZSRwcjggPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGhpcyQkc3RvcmUkc3RhdGUkcHI5ID0gX3RoaXMkJHN0b3JlJHN0YXRlJHByOC5zZXR0aW5ncykgPT09IG51bGwgfHwgX3RoaXMkJHN0b3JlJHN0YXRlJHByOSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkJHN0b3JlJHN0YXRlJHByOS5iZWRfbWVzaDsKCiAgICAgIGlmIChjb25maWcpIHsKICAgICAgICB2YXIgcHJvYmVfY291bnQgPSBbMSwgMV07CgogICAgICAgIGlmIChjb25maWcucHJvYmVfY291bnQgJiYgdHlwZW9mIGNvbmZpZy5wcm9iZV9jb3VudCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIHByb2JlX2NvdW50ID0gY29uZmlnLnByb2JlX2NvdW50LnNwbGl0KCcsJyk7CiAgICAgICAgfSBlbHNlIGlmIChjb25maWcucHJvYmVfY291bnQpIHsKICAgICAgICAgIHByb2JlX2NvdW50ID0gY29uZmlnLnByb2JlX2NvdW50OwogICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnJvdW5kX3Byb2JlX2NvdW50KSB7CiAgICAgICAgICBwcm9iZV9jb3VudCA9IFtjb25maWcucm91bmRfcHJvYmVfY291bnQsIGNvbmZpZy5yb3VuZF9wcm9iZV9jb3VudF07CiAgICAgICAgfQoKICAgICAgICB2YXIgbWVzaF9taW4gPSBbXTsKICAgICAgICB2YXIgbWVzaF9tYXggPSBbXTsKCiAgICAgICAgaWYgKGNvbmZpZy5tZXNoX21pbiAmJiBjb25maWcubWVzaF9tYXgpIHsKICAgICAgICAgIC8vIGlzIG5vIGRlbHRhCiAgICAgICAgICBtZXNoX21pbiA9IHR5cGVvZiBjb25maWcubWVzaF9taW4gPT09ICdzdHJpbmcnID8gY29uZmlnLm1lc2hfbWluLnNwbGl0KCcsJykgOiBjb25maWcubWVzaF9taW47CiAgICAgICAgICBtZXNoX21heCA9IHR5cGVvZiBjb25maWcubWVzaF9tYXggPT09ICdzdHJpbmcnID8gY29uZmlnLm1lc2hfbWF4LnNwbGl0KCcsJykgOiBjb25maWcubWVzaF9tYXg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIGRlbHRhIG1pbi9tYXgKICAgICAgICAgIG1lc2hfbWluID0gW2NvbmZpZy5tZXNoX3JhZGl1cyAqIC0xLCBjb25maWcubWVzaF9yYWRpdXMgKiAtMV07CiAgICAgICAgICBtZXNoX21heCA9IFtjb25maWcubWVzaF9yYWRpdXMsIGNvbmZpZy5tZXNoX3JhZGl1c107CiAgICAgICAgfQoKICAgICAgICB2YXIgeENvdW50ID0gcHJvYmVfY291bnRbMF07CiAgICAgICAgdmFyIHlDb3VudCA9IHByb2JlX2NvdW50WzFdOwogICAgICAgIHZhciB4TWluID0gcGFyc2VGbG9hdChtZXNoX21pblswXSk7CiAgICAgICAgdmFyIHhNYXggPSBwYXJzZUZsb2F0KG1lc2hfbWF4WzBdKTsKICAgICAgICB2YXIgeU1pbiA9IHBhcnNlRmxvYXQobWVzaF9taW5bMV0pOwogICAgICAgIHZhciB5TWF4ID0gcGFyc2VGbG9hdChtZXNoX21heFsxXSk7CiAgICAgICAgdmFyIHhTdGVwID0gKHhNYXggLSB4TWluKSAvICh4Q291bnQgLSAxKTsKICAgICAgICB2YXIgeVN0ZXAgPSAoeU1heCAtIHlNaW4pIC8gKHlDb3VudCAtIDEpOwogICAgICAgIHZhciBkYXRhID0gW107CgogICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgeUNvdW50OyB5KyspIHsKICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgeENvdW50OyB4KyspIHsKICAgICAgICAgICAgZGF0YS5wdXNoKFt4TWluICsgeFN0ZXAgKiB4LCB5TWluICsgeVN0ZXAgKiB5LCAwXSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzZXJpZS5kYXRhID0gZGF0YTsKICAgICAgICBzZXJpZS5kYXRhU2hhcGUgPSBbeUNvdW50LCB4Q291bnRdOwogICAgICB9CgogICAgICByZXR1cm4gc2VyaWU7CiAgICB9CiAgfSwgewogICAga2V5OiAidmlzdWFsTWFwUmFuZ2UiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIGlmICghdGhpcy5zY2FsZVZpc3VhbE1hcCkgcmV0dXJuIFstMC4xLCAwLjFdOwogICAgICByZXR1cm4gdGhpcy5oZWlnaHRtYXBMaW1pdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ2aXN1YWxNYXBTZXJpZXNJbmRleCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG91dHB1dCA9IFtdOwogICAgICBpZiAodGhpcy5zaG93UHJvYmVkKSBvdXRwdXQucHVzaCgwKTtlbHNlIGlmICh0aGlzLnNob3dNZXNoKSBvdXRwdXQucHVzaCgxKTsKICAgICAgcmV0dXJuIG91dHB1dDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJiZWRNZXNoTWF4UG9pbnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIGlmICh0aGlzLmJlZF9tZXNoLnByb2ZpbGVfbmFtZSA9PT0gJycpIHJldHVybiB7CiAgICAgICAgcm93OiAwLAogICAgICAgIGNvbDogMCwKICAgICAgICBwb3NpdGlvblg6IDAsCiAgICAgICAgcG9zaXRpb25ZOiAwLAogICAgICAgIHZhbHVlOiAwCiAgICAgIH07CgogICAgICB2YXIgX3RoaXMkcHJvYmVkSGVpZ2h0bWFwID0gX3NsaWNlZFRvQXJyYXkodGhpcy5wcm9iZWRIZWlnaHRtYXBMaW1pdCwgMiksCiAgICAgICAgICBtYXggPSBfdGhpcyRwcm9iZWRIZWlnaHRtYXBbMV07CgogICAgICB2YXIgcm93ID0gMDsKICAgICAgdmFyIGNvbCA9IDA7CiAgICAgIHRoaXMuYmVkX21lc2gucHJvYmVkX21hdHJpeC5mb3JFYWNoKGZ1bmN0aW9uIChyb3dQb2ludHMsIGluZGV4KSB7CiAgICAgICAgaWYgKE1hdGgubWF4LmFwcGx5KE1hdGgsIF90b0NvbnN1bWFibGVBcnJheShyb3dQb2ludHMpKSA9PT0gbWF4KSB7CiAgICAgICAgICByb3cgPSBpbmRleCArIDE7CiAgICAgICAgICBjb2wgPSByb3dQb2ludHMuZmluZEluZGV4KGZ1bmN0aW9uIChwb2ludCkgewogICAgICAgICAgICByZXR1cm4gcG9pbnQgPT09IG1heDsKICAgICAgICAgIH0pICsgMTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB2YXIgcG9zaXRpb25YID0gTWF0aC5yb3VuZCgodGhpcy5iZWRfbWVzaC5tZXNoX21pblswXSArICh0aGlzLmJlZF9tZXNoLm1lc2hfbWF4WzBdIC0gdGhpcy5iZWRfbWVzaC5tZXNoX21pblswXSkgLyB0aGlzLmJlZF9tZXNoLnByb2JlZF9tYXRyaXhbMF0ubGVuZ3RoICogKGNvbCAtIDEpKSAqIDEwKSAvIDEwOwogICAgICB2YXIgcG9zaXRpb25ZID0gTWF0aC5yb3VuZCgodGhpcy5iZWRfbWVzaC5tZXNoX21pblsxXSArICh0aGlzLmJlZF9tZXNoLm1lc2hfbWF4WzFdIC0gdGhpcy5iZWRfbWVzaC5tZXNoX21pblsxXSkgLyB0aGlzLmJlZF9tZXNoLnByb2JlZF9tYXRyaXgubGVuZ3RoICogKHJvdyAtIDEpKSAqIDEwKSAvIDEwOwogICAgICByZXR1cm4gewogICAgICAgIHJvdzogcm93LAogICAgICAgIGNvbDogY29sLAogICAgICAgIHBvc2l0aW9uWDogcG9zaXRpb25YLAogICAgICAgIHBvc2l0aW9uWTogcG9zaXRpb25ZLAogICAgICAgIHZhbHVlOiBNYXRoLnJvdW5kKG1heCAqIDEwMDApIC8gMTAwMAogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImJlZE1lc2hNaW5Qb2ludCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgaWYgKHRoaXMuYmVkX21lc2gucHJvZmlsZV9uYW1lID09PSAnJykgcmV0dXJuIHsKICAgICAgICByb3c6IDAsCiAgICAgICAgY29sOiAwLAogICAgICAgIHBvc2l0aW9uWDogMCwKICAgICAgICBwb3NpdGlvblk6IDAsCiAgICAgICAgdmFsdWU6IDAKICAgICAgfTsKCiAgICAgIHZhciBfdGhpcyRwcm9iZWRIZWlnaHRtYXAyID0gX3NsaWNlZFRvQXJyYXkodGhpcy5wcm9iZWRIZWlnaHRtYXBMaW1pdCwgMSksCiAgICAgICAgICBtaW4gPSBfdGhpcyRwcm9iZWRIZWlnaHRtYXAyWzBdOwoKICAgICAgdmFyIHJvdyA9IDA7CiAgICAgIHZhciBjb2wgPSAwOwogICAgICB0aGlzLmJlZF9tZXNoLnByb2JlZF9tYXRyaXguZm9yRWFjaChmdW5jdGlvbiAocm93UG9pbnRzLCBpbmRleCkgewogICAgICAgIGlmIChNYXRoLm1pbi5hcHBseShNYXRoLCBfdG9Db25zdW1hYmxlQXJyYXkocm93UG9pbnRzKSkgPT09IG1pbikgewogICAgICAgICAgcm93ID0gaW5kZXggKyAxOwogICAgICAgICAgY29sID0gcm93UG9pbnRzLmZpbmRJbmRleChmdW5jdGlvbiAocG9pbnQpIHsKICAgICAgICAgICAgcmV0dXJuIHBvaW50ID09PSBtaW47CiAgICAgICAgICB9KSArIDE7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdmFyIHBvc2l0aW9uWCA9IE1hdGgucm91bmQoKHRoaXMuYmVkX21lc2gubWVzaF9taW5bMF0gKyAodGhpcy5iZWRfbWVzaC5tZXNoX21heFswXSAtIHRoaXMuYmVkX21lc2gubWVzaF9taW5bMF0pIC8gdGhpcy5iZWRfbWVzaC5wcm9iZWRfbWF0cml4WzBdLmxlbmd0aCAqIChjb2wgLSAxKSkgKiAxMCkgLyAxMDsKICAgICAgdmFyIHBvc2l0aW9uWSA9IE1hdGgucm91bmQoKHRoaXMuYmVkX21lc2gubWVzaF9taW5bMV0gKyAodGhpcy5iZWRfbWVzaC5tZXNoX21heFsxXSAtIHRoaXMuYmVkX21lc2gubWVzaF9taW5bMV0pIC8gdGhpcy5iZWRfbWVzaC5wcm9iZWRfbWF0cml4Lmxlbmd0aCAqIChyb3cgLSAxKSkgKiAxMCkgLyAxMDsKICAgICAgcmV0dXJuIHsKICAgICAgICByb3c6IHJvdywKICAgICAgICBjb2w6IGNvbCwKICAgICAgICBwb3NpdGlvblg6IHBvc2l0aW9uWCwKICAgICAgICBwb3NpdGlvblk6IHBvc2l0aW9uWSwKICAgICAgICB2YWx1ZTogTWF0aC5yb3VuZChtaW4gKiAxMDAwKSAvIDEwMDAKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtZXNoTG9hZGVkIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAodGhpcy5iZWRfbWVzaCAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLmJlZF9tZXNoLnByb2ZpbGVfbmFtZSAhPT0gJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAidG9vbHRpcEZvcm1hdHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9vbHRpcEZvcm1hdHRlcihkYXRhKSB7CiAgICAgIHZhciBvdXRwdXRBcnJheSA9IFtdOwogICAgICBvdXRwdXRBcnJheS5wdXNoKCc8Yj4nICsgZGF0YS5zZXJpZXNOYW1lICsgJzwvYj4nKTsKICAgICAgT2JqZWN0LmtleXMoZGF0YS5lbmNvZGUpLnNvcnQoKS5mb3JFYWNoKGZ1bmN0aW9uIChheGlzTmFtZSkgewogICAgICAgIG91dHB1dEFycmF5LnB1c2goJzxiPicgKyBheGlzTmFtZS50b1VwcGVyQ2FzZSgpICsgJzwvYj46ICcgKyBkYXRhLmRhdGFbZGF0YS5lbmNvZGVbYXhpc05hbWVdWzBdXS50b0ZpeGVkKGF4aXNOYW1lID09PSAneicgPyAzIDogMSkgKyAnIG1tJyk7CiAgICAgIH0pOwogICAgICByZXR1cm4gb3V0cHV0QXJyYXkuam9pbignPGJyIC8+Jyk7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9hZFByb2ZpbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRQcm9maWxlKG5hbWUpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NlcnZlci9hZGRFdmVudCcsIHsKICAgICAgICBtZXNzYWdlOiAnQkVEX01FU0hfUFJPRklMRSBMT0FEPScgKyBuYW1lLAogICAgICAgIHR5cGU6ICdjb21tYW5kJwogICAgICB9KTsKICAgICAgdGhpcy4kc29ja2V0LmVtaXQoJ3ByaW50ZXIuZ2NvZGUuc2NyaXB0JywgewogICAgICAgIHNjcmlwdDogJ0JFRF9NRVNIX1BST0ZJTEUgTE9BRD0nICsgbmFtZQogICAgICB9LCB7CiAgICAgICAgbG9hZGluZzogJ2JlZE1lc2hMb2FkXycgKyBuYW1lCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIm9wZW5SZW5hbWVQcm9maWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuUmVuYW1lUHJvZmlsZSgpIHsKICAgICAgdmFyIF90aGlzJGJlZF9tZXNoJHByb2ZpbCwKICAgICAgICAgIF90aGlzJGJlZF9tZXNoLAogICAgICAgICAgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMubmV3TmFtZSA9IChfdGhpcyRiZWRfbWVzaCRwcm9maWwgPSAoX3RoaXMkYmVkX21lc2ggPSB0aGlzLmJlZF9tZXNoKSA9PT0gbnVsbCB8fCBfdGhpcyRiZWRfbWVzaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkYmVkX21lc2gucHJvZmlsZV9uYW1lKSAhPT0gbnVsbCAmJiBfdGhpcyRiZWRfbWVzaCRwcm9maWwgIT09IHZvaWQgMCA/IF90aGlzJGJlZF9tZXNoJHByb2ZpbCA6ICcnOwogICAgICB0aGlzLm9sZE5hbWUgPSB0aGlzLmJlZF9tZXNoLnByb2ZpbGVfbmFtZTsKICAgICAgdGhpcy5yZW5hbWVEaWFsb2cgPSB0cnVlOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3RoaXMyJCRyZWZzJGlucHV0RGlhOwoKICAgICAgICAoX3RoaXMyJCRyZWZzJGlucHV0RGlhID0gX3RoaXMyLiRyZWZzLmlucHV0RGlhbG9nUmVuYW1lSGVpZ2h0bWFwTmFtZSkgPT09IG51bGwgfHwgX3RoaXMyJCRyZWZzJGlucHV0RGlhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpczIkJHJlZnMkaW5wdXREaWEuZm9jdXMoKTsKICAgICAgfSwgMjAwKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5hbWVQcm9maWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5hbWVQcm9maWxlKCkgewogICAgICB0aGlzLnJlbmFtZURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2VydmVyL2FkZEV2ZW50JywgewogICAgICAgIG1lc3NhZ2U6ICdCRURfTUVTSF9QUk9GSUxFIFNBVkU9JyArIHRoaXMubmV3TmFtZSwKICAgICAgICB0eXBlOiAnY29tbWFuZCcKICAgICAgfSk7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzZXJ2ZXIvYWRkRXZlbnQnLCB7CiAgICAgICAgbWVzc2FnZTogJ0JFRF9NRVNIX1BST0ZJTEUgUkVNT1ZFPScgKyB0aGlzLm9sZE5hbWUsCiAgICAgICAgdHlwZTogJ2NvbW1hbmQnCiAgICAgIH0pOwogICAgICB0aGlzLiRzb2NrZXQuZW1pdCgncHJpbnRlci5nY29kZS5zY3JpcHQnLCB7CiAgICAgICAgc2NyaXB0OiAnQkVEX01FU0hfUFJPRklMRSBTQVZFPScgKyB0aGlzLm5ld05hbWUKICAgICAgfSwgewogICAgICAgIGxvYWRpbmc6ICdiZWRNZXNoUmVuYW1lJwogICAgICB9KTsKICAgICAgdGhpcy4kc29ja2V0LmVtaXQoJ3ByaW50ZXIuZ2NvZGUuc2NyaXB0JywgewogICAgICAgIHNjcmlwdDogJ0JFRF9NRVNIX1BST0ZJTEUgUkVNT1ZFPScgKyB0aGlzLm9sZE5hbWUKICAgICAgfSwgewogICAgICAgIGxvYWRpbmc6ICdiZWRNZXNoUmVuYW1lJwogICAgICB9KTsKICAgICAgdGhpcy5uZXdOYW1lID0gJyc7CiAgICAgIHRoaXMub2xkTmFtZSA9ICcnOwogICAgfQogIH0sIHsKICAgIGtleTogIm9wZW5SZW1vdmVQcm9maWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuUmVtb3ZlUHJvZmlsZShuYW1lKSB7CiAgICAgIHRoaXMucmVtb3ZlRGlhbG9nUHJvZmlsZSA9IG5hbWU7CiAgICAgIHRoaXMucmVtb3ZlRGlhbG9nID0gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVQcm9maWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVQcm9maWxlKCkgewogICAgICB0aGlzLnJlbW92ZURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2VydmVyL2FkZEV2ZW50JywgewogICAgICAgIG1lc3NhZ2U6ICdCRURfTUVTSF9QUk9GSUxFIFJFTU9WRT0nICsgdGhpcy5yZW1vdmVEaWFsb2dQcm9maWxlLAogICAgICAgIHR5cGU6ICdjb21tYW5kJwogICAgICB9KTsKICAgICAgdGhpcy4kc29ja2V0LmVtaXQoJ3ByaW50ZXIuZ2NvZGUuc2NyaXB0JywgewogICAgICAgIHNjcmlwdDogJ0JFRF9NRVNIX1BST0ZJTEUgUkVNT1ZFPScgKyB0aGlzLnJlbW92ZURpYWxvZ1Byb2ZpbGUKICAgICAgfSwgewogICAgICAgIGFjdGlvbjogJ3ByaW50ZXIvcmVtb3ZlQmVkTWVzaFByb2ZpbGUnLAogICAgICAgIGFjdGlvblBheWxvYWQ6IHsKICAgICAgICAgIG5hbWU6IHRoaXMucmVtb3ZlRGlhbG9nUHJvZmlsZQogICAgICAgIH0sCiAgICAgICAgbG9hZGluZzogJ2JlZE1lc2hSZW5hbWVfJyArIHRoaXMucmVtb3ZlRGlhbG9nUHJvZmlsZQogICAgICB9KTsKICAgICAgdGhpcy5yZW1vdmVEaWFsb2dQcm9maWxlID0gJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiaG9tZVByaW50ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhvbWVQcmludGVyKCkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2VydmVyL2FkZEV2ZW50JywgewogICAgICAgIG1lc3NhZ2U6ICdHMjgnLAogICAgICAgIHR5cGU6ICdjb21tYW5kJwogICAgICB9KTsKICAgICAgdGhpcy4kc29ja2V0LmVtaXQoJ3ByaW50ZXIuZ2NvZGUuc2NyaXB0JywgewogICAgICAgIHNjcmlwdDogJ0cyOCcKICAgICAgfSwgewogICAgICAgIGxvYWRpbmc6ICdob21lQWxsJwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbGVhckJlZE1lc2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyQmVkTWVzaCgpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NlcnZlci9hZGRFdmVudCcsIHsKICAgICAgICBtZXNzYWdlOiAnQkVEX01FU0hfQ0xFQVInLAogICAgICAgIHR5cGU6ICdjb21tYW5kJwogICAgICB9KTsKICAgICAgdGhpcy4kc29ja2V0LmVtaXQoJ3ByaW50ZXIuZ2NvZGUuc2NyaXB0JywgewogICAgICAgIHNjcmlwdDogJ0JFRF9NRVNIX0NMRUFSJwogICAgICB9LCB7CiAgICAgICAgbG9hZGluZzogJ2JlZE1lc2hDbGVhcicKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2FsaWJyYXRlTWVzaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2FsaWJyYXRlTWVzaCgpIHsKICAgICAgdGhpcy5jYWxpYnJhdGVEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NlcnZlci9hZGRFdmVudCcsIHsKICAgICAgICBtZXNzYWdlOiAnQkVEX01FU0hfQ0FMSUJSQVRFJywKICAgICAgICB0eXBlOiAnY29tbWFuZCcKICAgICAgfSk7CiAgICAgIHRoaXMuJHNvY2tldC5lbWl0KCdwcmludGVyLmdjb2RlLnNjcmlwdCcsIHsKICAgICAgICBzY3JpcHQ6ICdCRURfTUVTSF9DQUxJQlJBVEUnCiAgICAgIH0sIHsKICAgICAgICBsb2FkaW5nOiAnYmVkTWVzaENhbGlicmF0ZScKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYmVmb3JlRGVzdHJveSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm47CiAgICAgIGlmICh0aGlzLmNoYXJ0KSB0aGlzLmNoYXJ0LmRpc3Bvc2UoKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBQYWdlSGVpZ2h0bWFwOwp9KE1peGlucyhCYXNlTWl4aW4sIENvbnRyb2xNaXhpbikpOwoKX19kZWNvcmF0ZShbV2F0Y2goJ2JlZF9tZXNoJywgewogIGRlZXA6IHRydWUKfSldLCBQYWdlSGVpZ2h0bWFwLnByb3RvdHlwZSwgImJlZF9tZXNoQ2hhbmdlZCIsIG51bGwpOwoKUGFnZUhlaWdodG1hcCA9IF9fZGVjb3JhdGUoW0NvbXBvbmVudCh7CiAgY29tcG9uZW50czogewogICAgUGFuZWw6IFBhbmVsLAogICAgRUNoYXJ0czogY3JlYXRlQ29tcG9uZW50KHsKICAgICAgZWNoYXJ0czogZWNoYXJ0cwogICAgfSkKICB9Cn0pXSwgUGFnZUhlaWdodG1hcCk7CmV4cG9ydCBkZWZhdWx0IFBhZ2VIZWlnaHRtYXA7"},null]}