{"remainingRequest":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/panels/MiniconsolePanel.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/panels/MiniconsolePanel.vue","mtime":1644874918000},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/babel-loader/lib/index.js","mtime":1645990067759},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/ts-loader/index.js","mtime":1645990068168},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1645990069130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgppbXBvcnQgeyBzdHJMb25nZXN0RXF1YWwsIHJldmVyc2VTdHJpbmd9IGZyb20gJ0AvcGx1Z2lucy9oZWxwZXJzJwppbXBvcnQge0NvbXBvbmVudCwgTWl4aW5zLCBXYXRjaH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcicKaW1wb3J0IEJhc2VNaXhpbiBmcm9tICdAL2NvbXBvbmVudHMvbWl4aW5zL2Jhc2UnCmltcG9ydCB7Q29tbWFuZEhlbHAsIFZUZXh0YXJlYVR5cGV9IGZyb20gJ0Avc3RvcmUvcHJpbnRlci90eXBlcycKaW1wb3J0IENvbnNvbGVUYWJsZSBmcm9tICdAL2NvbXBvbmVudHMvY29uc29sZS9Db25zb2xlVGFibGUudnVlJwppbXBvcnQgQ29tbWFuZEhlbHBNb2RhbCBmcm9tICdAL2NvbXBvbmVudHMvQ29tbWFuZEhlbHBNb2RhbC52dWUnCmltcG9ydCBQYW5lbCBmcm9tICdAL2NvbXBvbmVudHMvdWkvUGFuZWwudnVlJwoKQENvbXBvbmVudCh7CiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgUGFuZWwsCiAgICAgICAgQ29uc29sZVRhYmxlLAogICAgICAgIENvbW1hbmRIZWxwTW9kYWwKICAgIH0KfSkKZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWluaWNvbnNvbGVQYW5lbCBleHRlbmRzIE1peGlucyhCYXNlTWl4aW4pIHsKICAgICRyZWZzITogewogICAgICAgIGdjb2RlQ29tbWFuZEZpZWxkOiBWVGV4dGFyZWFUeXBlLAogICAgICAgIGNvbnNvbGU6IENvbnNvbGVUYWJsZSwKICAgICAgICBtaW5pQ29uc29sZVNjcm9sbDogYW55CiAgICB9CgogICAgcHJpdmF0ZSBnY29kZSA9ICcnCiAgICBwcml2YXRlIGxhc3RDb21tYW5kTnVtYmVyOiBudW1iZXIgfCBudWxsID0gbnVsbAogICAgcHJpdmF0ZSBpdGVtcyA9IFtdOwogICAgcHJpdmF0ZSBjbWRMaXN0U2VhcmNoOiBzdHJpbmcgfCBudWxsID0gbnVsbAoKICAgIGdldCBoZWxwbGlzdCgpOiBDb21tYW5kSGVscFtdIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUucHJpbnRlci5oZWxwbGlzdCA/PyBbXQogICAgfQoKICAgIGdldCBjb25zb2xlRGlyZWN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5ndWkuY29uc29sZS5kaXJlY3Rpb24gPz8gJ3RhYmxlJwogICAgfQoKICAgIGdldCBjb25zb2xlSGVpZ2h0KCkgewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5ndWkuY29uc29sZS5oZWlnaHQgPz8gMzAwCiAgICB9CgogICAgZ2V0IGV2ZW50cygpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snc2VydmVyL2dldENvbnNvbGVFdmVudHMnXSh0aGlzLmNvbnNvbGVEaXJlY3Rpb24gPT09ICd0YWJsZScsIDI1MCkKICAgIH0KCgogICAgQFdhdGNoKCdldmVudHMnKQogICAgZXZlbnRzQ2hhbmdlZCgpIHsKICAgICAgICBpZiAodGhpcy5jb25zb2xlRGlyZWN0aW9uID09PSAnc2hlbGwnKXsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCkKICAgICAgICAgICAgfSwgNTApCiAgICAgICAgfQogICAgfQoKICAgIGdldCBoaWRlV2FpdFRlbXBlcmF0dXJlcygpOiBib29sZWFuIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZ3VpLmNvbnNvbGUuaGlkZVdhaXRUZW1wZXJhdHVyZXMKICAgIH0KCiAgICBzZXQgaGlkZVdhaXRUZW1wZXJhdHVyZXMobmV3VmFsKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2d1aS9zYXZlU2V0dGluZycsIHsgbmFtZTogJ2NvbnNvbGUuaGlkZVdhaXRUZW1wZXJhdHVyZXMnLCB2YWx1ZTogbmV3VmFsIH0pCiAgICB9CgogICAgZ2V0IGhpZGVUbENvbW1hbmRzKCk6IGJvb2xlYW4gewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5ndWkuY29uc29sZS5oaWRlVGxDb21tYW5kcwogICAgfQoKICAgIHNldCBoaWRlVGxDb21tYW5kcyhuZXdWYWwpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3VpL3NhdmVTZXR0aW5nJywgeyBuYW1lOiAnY29uc29sZS5oaWRlVGxDb21tYW5kcycsIHZhbHVlOiBuZXdWYWwgfSkKICAgIH0KCiAgICBnZXQgY3VzdG9tRmlsdGVycygpOiBhbnlbXSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmd1aS5jb25zb2xlLmNvbnNvbGVmaWx0ZXJzCiAgICB9CgogICAgZ2V0IHJvd3MoKTogbnVtYmVyIHsKICAgICAgICByZXR1cm4gdGhpcy5nY29kZT8uc3BsaXQoJ1xuJykubGVuZ3RoID8/IDEKICAgIH0KCiAgICBnZXQgbGFzdENvbW1hbmRzKCk6IHN0cmluZ1tdIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZ3VpLmdjb2RlaGlzdG9yeS5lbnRyaWVzID8/IFtdCiAgICB9CgogICAgY29tbWFuZENsaWNrKG1zZzogc3RyaW5nKTogdm9pZCB7CiAgICAgICAgdGhpcy5nY29kZSA9IG1zZwoKICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMuZ2NvZGVDb21tYW5kRmllbGQuZm9jdXMoKQogICAgICAgIH0pCiAgICB9CgogICAgZG9TZW5kKGNtZDogS2V5Ym9hcmRFdmVudCkgewogICAgICAgIGlmICghY21kLnNoaWZ0S2V5KSB7CiAgICAgICAgICAgIGlmICh0aGlzLmdjb2RlICE9PSAnJykgewogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3ByaW50ZXIvc2VuZEdjb2RlJywgdGhpcy5nY29kZSkKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdndWkvZ2NvZGVoaXN0b3J5L2FkZFRvSGlzdG9yeScsIHRoaXMuZ2NvZGUpCiAgICAgICAgICAgICAgICB0aGlzLmdjb2RlID0gJycKICAgICAgICAgICAgICAgIHRoaXMubGFzdENvbW1hbmROdW1iZXIgPSBudWxsCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLmNvbnNvbGUuJGVsLnNjcm9sbCh7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDIwKQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5nY29kZSArPSAnXG4nCiAgICAgICAgfQogICAgfQoKICAgIG9uS2V5VXAoKTogdm9pZCB7CiAgICAgICAgaWYgKHRoaXMubGFzdENvbW1hbmROdW1iZXIgPT09IG51bGwgJiYgdGhpcy5sYXN0Q29tbWFuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgIHRoaXMubGFzdENvbW1hbmROdW1iZXIgPSB0aGlzLmxhc3RDb21tYW5kcy5sZW5ndGggLSAxCiAgICAgICAgICAgIHRoaXMuZ2NvZGUgPSB0aGlzLmxhc3RDb21tYW5kc1t0aGlzLmxhc3RDb21tYW5kTnVtYmVyXQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5sYXN0Q29tbWFuZE51bWJlciAmJiB0aGlzLmxhc3RDb21tYW5kTnVtYmVyID4gMCkgewogICAgICAgICAgICB0aGlzLmxhc3RDb21tYW5kTnVtYmVyLS0KICAgICAgICAgICAgdGhpcy5nY29kZSA9IHRoaXMubGFzdENvbW1hbmRzW3RoaXMubGFzdENvbW1hbmROdW1iZXJdCiAgICAgICAgfQogICAgfQoKICAgIG9uS2V5RG93bigpOiB2b2lkIHsKICAgICAgICBpZiAodGhpcy5sYXN0Q29tbWFuZE51bWJlciAhPT0gbnVsbCAmJiB0aGlzLmxhc3RDb21tYW5kTnVtYmVyIDwgKHRoaXMubGFzdENvbW1hbmRzLmxlbmd0aCAtIDEpKSB7CiAgICAgICAgICAgIHRoaXMubGFzdENvbW1hbmROdW1iZXIrKwogICAgICAgICAgICB0aGlzLmdjb2RlID0gdGhpcy5sYXN0Q29tbWFuZHNbdGhpcy5sYXN0Q29tbWFuZE51bWJlcl0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMubGFzdENvbW1hbmROdW1iZXIgIT09IG51bGwgJiYgdGhpcy5sYXN0Q29tbWFuZE51bWJlciA9PT0gKHRoaXMubGFzdENvbW1hbmRzLmxlbmd0aCAtIDEpKSB7CiAgICAgICAgICAgIHRoaXMubGFzdENvbW1hbmROdW1iZXIgPSBudWxsCiAgICAgICAgICAgIHRoaXMuZ2NvZGUgPSAnJwogICAgICAgIH0KICAgIH0KCiAgICBnZXRBdXRvY29tcGxldGUoZTogRXZlbnQpOiB2b2lkIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCkKICAgICAgICBpZiAodGhpcy5nY29kZS5sZW5ndGgpIHsKICAgICAgICAgICAgbGV0IGNoZWNrID0gdGhpcy5nY29kZS50b0xvd2VyQ2FzZSgpCiAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gdGhpcy4kcmVmcy5nY29kZUNvbW1hbmRGaWVsZC4kcmVmcy5pbnB1dAogICAgICAgICAgICBjb25zdCBzZW50ZW5jZSA9IHRleHRhcmVhLnZhbHVlCiAgICAgICAgICAgIGNvbnN0IGxlbiA9IHNlbnRlbmNlLmxlbmd0aAogICAgICAgICAgICBjb25zdCBwb3MgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydAogICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZVBvcyA9IGxlbiAtIHJldmVyc2VTdHJpbmcoc2VudGVuY2UpLmluZGV4T2YoJ1xuJywgbGVuIC0gcG9zKQogICAgICAgICAgICBjb25zdCBjdXJyZW50RW5kUG9zID0gc2VudGVuY2UuaW5kZXhPZignXG4nLCBjdXJyZW50TGluZVBvcykgPiAtMSA/IHNlbnRlbmNlLmluZGV4T2YoJ1xuJywgY3VycmVudExpbmVQb3MpIC0gMSA6IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSCiAgICAgICAgICAgIGlmICh0aGlzLnJvd3MgPiAxKSB7CiAgICAgICAgICAgICAgICBjaGVjayA9IHNlbnRlbmNlLnN1YnN0cihjdXJyZW50TGluZVBvcywgY3VycmVudEVuZFBvcyAtIGN1cnJlbnRMaW5lUG9zKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBjb21tYW5kcyA9IHRoaXMuaGVscGxpc3QuZmlsdGVyKChlbGVtZW50KSA9PiBlbGVtZW50LmNvbW1hbmRMb3cuc3RhcnRzV2l0aChjaGVjay50b0xvd2VyQ2FzZSgpKSkKICAgICAgICAgICAgaWYgKGNvbW1hbmRzPy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvd3MgPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nY29kZSA9IHRoaXMuZ2NvZGUucmVwbGFjZShjaGVjaywgY29tbWFuZHNbMF0uY29tbWFuZCkKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nY29kZSA9IGNvbW1hbmRzWzBdLmNvbW1hbmQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmKGNvbW1hbmRzPy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICBsZXQgY29tbWFuZHMgPSB0aGlzLmhlbHBsaXN0LmZpbHRlcigoZWxlbWVudCkgPT4gZWxlbWVudC5jb21tYW5kTG93LnN0YXJ0c1dpdGgoY2hlY2sudG9Mb3dlckNhc2UoKSkpCiAgICAgICAgICAgICAgICBpZiAodGhpcy5yb3dzID4gMSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2NvZGUgPSB0aGlzLmdjb2RlLnJlcGxhY2UoY2hlY2ssIGNvbW1hbmRzLnJlZHVjZSgoYWNjLCB2YWwpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0ckxvbmdlc3RFcXVhbChhY2MsIHZhbC5jb21tYW5kKQogICAgICAgICAgICAgICAgICAgIH0sIGNvbW1hbmRzWzBdLmNvbW1hbmQpKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmdjb2RlID0gY29tbWFuZHMucmVkdWNlKChhY2MsIHZhbCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyTG9uZ2VzdEVxdWFsKGFjYywgdmFsLmNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgfSwgY29tbWFuZHNbMF0uY29tbWFuZCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb21tYW5kcyAmJiBjb21tYW5kcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgb3V0cHV0ID0gJycKICAgICAgICAgICAgICAgICAgICBjb21tYW5kcy5mb3JFYWNoKGNvbW1hbmQgPT4gb3V0cHV0ICs9ICc8YSBjbGFzcz0iY29tbWFuZCBibHVlLS10ZXh0IGZvbnQtd2VpZ2h0LWJvbGQiPicrY29tbWFuZC5jb21tYW5kKyc8L2E+OiAnK2NvbW1hbmQuZGVzY3JpcHRpb24rJzxiciAvPicpCgogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzZXJ2ZXIvYWRkRXZlbnQnLCB7IG1lc3NhZ2U6IG91dHB1dCwgdHlwZTogJ2F1dG9jb21wbGV0ZScgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLiRyZWZzLmdjb2RlQ29tbWFuZEZpZWxkLmZvY3VzKCkKICAgIH0KCiAgICB0b2dnbGVGaWx0ZXIoZmlsdGVyOiBzdHJpbmcpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3VpL3VwZGF0ZUNvbnNvbGVGaWx0ZXInLCAgZmlsdGVyKQogICAgfQoKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgaWYgKHRoaXMuY29uc29sZURpcmVjdGlvbiA9PT0gJ3NoZWxsJykgdGhpcy5zY3JvbGxUb0JvdHRvbSgpCiAgICB9CgogICAgc2Nyb2xsVG9Cb3R0b20oKSB7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICBpZiAodGhpcy4kcmVmcy5taW5pQ29uc29sZVNjcm9sbCkgewogICAgICAgICAgICAgICAgY29uc3Qgb3ZlcmxheXNjcm9sbCA9IHRoaXMuJHJlZnMubWluaUNvbnNvbGVTY3JvbGwub3NJbnN0YW5jZSgpCiAgICAgICAgICAgICAgICBvdmVybGF5c2Nyb2xsPy5zY3JvbGwoeyB5OiAnMTAwJScgfSkKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICB9CgogICAgc2Nyb2xsVG9Ub3AoKSB7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICBpZiAodGhpcy4kcmVmcy5taW5pQ29uc29sZVNjcm9sbCkgewogICAgICAgICAgICAgICAgY29uc3Qgb3ZlcmxheXNjcm9sbCA9IHRoaXMuJHJlZnMubWluaUNvbnNvbGVTY3JvbGwub3NJbnN0YW5jZSgpCiAgICAgICAgICAgICAgICBvdmVybGF5c2Nyb2xsPy5zY3JvbGwoeyB5OiAnMCUnIH0pCiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgfQp9Cg=="},{"version":3,"sources":["MiniconsolePanel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MiniconsolePanel.vue","sourceRoot":"src/components/panels","sourcesContent":["<style scoped lang=\"scss\">\n\n    .consoleTable {\n        border-top: 1px solid rgba(255, 255, 255, 0.12);\n    }\n\n    .gcode-command-field {\n        font-family: 'Roboto Mono', monospace;\n    }\n</style>\n\n<template>\n    <panel\n        v-if=\"socketIsConnected && klipperState !== 'disconnected'\"\n        icon=\"mdi-console-line\"\n        :title=\"$t('Panels.MiniconsolePanel.Headline')\"\n        :collapsible=\"true\"\n        card-class=\"miniconsole-panel\"\n        :hideButtonsOnCollapse=\"true\"\n    >\n        <template v-slot:buttons>\n            <command-help-modal @onCommand=\"gcode = $event\" :inToolbar=\"true\" ></command-help-modal>\n\n            <v-menu :offset-y=\"true\" :close-on-content-click=\"false\" :title=\"$t('Panels.MiniconsolePanel.SetupConsole')\">\n                <template v-slot:activator=\"{ on, attrs }\">\n                    <v-btn icon tile v-bind=\"attrs\" v-on=\"on\"><v-icon small>mdi-filter</v-icon></v-btn>\n                </template>\n                <v-list>\n                    <v-list-item class=\"minHeight36\">\n                        <v-checkbox class=\"mt-0\" v-model=\"hideWaitTemperatures\" hide-details :label=\"$t('Panels.MiniconsolePanel.HideTemperatures')\"></v-checkbox>\n                    </v-list-item>\n                    <v-list-item class=\"minHeight36\" v-if=\"moonrakerComponents.includes('timelapse')\">\n                        <v-checkbox class=\"mt-0\" v-model=\"hideTlCommands\" hide-details :label=\"$t('Panels.MiniconsolePanel.HideTimelapse')\"></v-checkbox>\n                    </v-list-item>\n                    <v-list-item class=\"minHeight36\" v-for=\"(filter, index) in customFilters\" v-bind:key=\"index\">\n                        <v-checkbox class=\"mt-0\" v-model=\"filter.bool\" @change=\"toggleFilter(filter)\" hide-details :label=\"filter.name\"></v-checkbox>\n                    </v-list-item>\n                </v-list>\n            </v-menu>\n\n        </template>\n        <div class=\"d-flex flex-column\">\n            <v-card-text :class=\"consoleDirection === 'table' ? 'order-1' : 'order-2'\">\n                <v-textarea\n                    v-model=\"gcode\"\n                    :items=\"items\"\n                    :label=\"$t('Panels.MiniconsolePanel.SendCode')\"\n                    solo\n                    class=\"gcode-command-field\"\n                    ref=\"gcodeCommandField\"\n                    autocomplete=\"off\"\n                    no-resize\n                    auto-grow\n                    :rows=\"rows\"\n                    @keydown.enter.prevent.stop=\"doSend\"\n                    @keyup.up=\"onKeyUp\"\n                    @keyup.down=\"onKeyDown\"\n                    @keydown.tab=\"getAutocomplete\"\n                    hide-details\n                    outlined\n                    dense\n                    :prepend-icon=\"isTouchDevice ? 'mdi-chevron-double-right' : ''\"\n                    @click:prepend=\"getAutocomplete\"\n                    append-icon=\"mdi-send\"\n                    @click:append=\"doSend\"\n                ></v-textarea>\n            </v-card-text>\n            <v-card-text :class=\"(consoleDirection === 'table' ? 'order-2' : 'order-1') + ' pa-0'\">\n                <v-row>\n                    <v-col>\n                        <overlay-scrollbars ref=\"miniConsoleScroll\" :style=\"'height: '+consoleHeight+'px;'\" :options=\"{ }\">\n                            <console-table ref=\"console\"\n                                           :events=\"events\"\n                                           :is-mini=\"true\"\n                                           @command-click=\"commandClick\"\n                            />\n                            <v-divider></v-divider>\n                        </overlay-scrollbars>\n                    </v-col>\n                </v-row>\n            </v-card-text>\n        </div>\n    </panel>\n</template>\n\n<script lang=\"ts\">\nimport { strLongestEqual, reverseString} from '@/plugins/helpers'\nimport {Component, Mixins, Watch} from 'vue-property-decorator'\nimport BaseMixin from '@/components/mixins/base'\nimport {CommandHelp, VTextareaType} from '@/store/printer/types'\nimport ConsoleTable from '@/components/console/ConsoleTable.vue'\nimport CommandHelpModal from '@/components/CommandHelpModal.vue'\nimport Panel from '@/components/ui/Panel.vue'\n\n@Component({\n    components: {\n        Panel,\n        ConsoleTable,\n        CommandHelpModal\n    }\n})\nexport default class MiniconsolePanel extends Mixins(BaseMixin) {\n    $refs!: {\n        gcodeCommandField: VTextareaType,\n        console: ConsoleTable,\n        miniConsoleScroll: any\n    }\n\n    private gcode = ''\n    private lastCommandNumber: number | null = null\n    private items = [];\n    private cmdListSearch: string | null = null\n\n    get helplist(): CommandHelp[] {\n        return this.$store.state.printer.helplist ?? []\n    }\n\n    get consoleDirection() {\n        return this.$store.state.gui.console.direction ?? 'table'\n    }\n\n    get consoleHeight() {\n        return this.$store.state.gui.console.height ?? 300\n    }\n\n    get events() {\n        return this.$store.getters['server/getConsoleEvents'](this.consoleDirection === 'table', 250)\n    }\n\n\n    @Watch('events')\n    eventsChanged() {\n        if (this.consoleDirection === 'shell'){\n            setTimeout(() => {\n                this.scrollToBottom()\n            }, 50)\n        }\n    }\n\n    get hideWaitTemperatures(): boolean {\n        return this.$store.state.gui.console.hideWaitTemperatures\n    }\n\n    set hideWaitTemperatures(newVal) {\n        this.$store.dispatch('gui/saveSetting', { name: 'console.hideWaitTemperatures', value: newVal })\n    }\n\n    get hideTlCommands(): boolean {\n        return this.$store.state.gui.console.hideTlCommands\n    }\n\n    set hideTlCommands(newVal) {\n        this.$store.dispatch('gui/saveSetting', { name: 'console.hideTlCommands', value: newVal })\n    }\n\n    get customFilters(): any[] {\n        return this.$store.state.gui.console.consolefilters\n    }\n\n    get rows(): number {\n        return this.gcode?.split('\\n').length ?? 1\n    }\n\n    get lastCommands(): string[] {\n        return this.$store.state.gui.gcodehistory.entries ?? []\n    }\n\n    commandClick(msg: string): void {\n        this.gcode = msg\n\n        this.$nextTick(() => {\n            this.$refs.gcodeCommandField.focus()\n        })\n    }\n\n    doSend(cmd: KeyboardEvent) {\n        if (!cmd.shiftKey) {\n            if (this.gcode !== '') {\n                this.$store.dispatch('printer/sendGcode', this.gcode)\n                this.$store.dispatch('gui/gcodehistory/addToHistory', this.gcode)\n                this.gcode = ''\n                this.lastCommandNumber = null\n                setTimeout(() => {\n                    this.$refs.console.$el.scroll({\n                        top: 0,\n                        left: 0,\n                        behavior: 'smooth'\n                    })\n                }, 20)\n            }\n        } else {\n            this.gcode += '\\n'\n        }\n    }\n\n    onKeyUp(): void {\n        if (this.lastCommandNumber === null && this.lastCommands.length) {\n            this.lastCommandNumber = this.lastCommands.length - 1\n            this.gcode = this.lastCommands[this.lastCommandNumber]\n        } else if (this.lastCommandNumber && this.lastCommandNumber > 0) {\n            this.lastCommandNumber--\n            this.gcode = this.lastCommands[this.lastCommandNumber]\n        }\n    }\n\n    onKeyDown(): void {\n        if (this.lastCommandNumber !== null && this.lastCommandNumber < (this.lastCommands.length - 1)) {\n            this.lastCommandNumber++\n            this.gcode = this.lastCommands[this.lastCommandNumber]\n        } else if (this.lastCommandNumber !== null && this.lastCommandNumber === (this.lastCommands.length - 1)) {\n            this.lastCommandNumber = null\n            this.gcode = ''\n        }\n    }\n\n    getAutocomplete(e: Event): void {\n        e.preventDefault()\n        if (this.gcode.length) {\n            let check = this.gcode.toLowerCase()\n            const textarea = this.$refs.gcodeCommandField.$refs.input\n            const sentence = textarea.value\n            const len = sentence.length\n            const pos = textarea.selectionStart\n            const currentLinePos = len - reverseString(sentence).indexOf('\\n', len - pos)\n            const currentEndPos = sentence.indexOf('\\n', currentLinePos) > -1 ? sentence.indexOf('\\n', currentLinePos) - 1 : Number.MAX_SAFE_INTEGER\n            if (this.rows > 1) {\n                check = sentence.substr(currentLinePos, currentEndPos - currentLinePos)\n            }\n            let commands = this.helplist.filter((element) => element.commandLow.startsWith(check.toLowerCase()))\n            if (commands?.length === 1) {\n                if (this.rows > 1) {\n                    this.gcode = this.gcode.replace(check, commands[0].command)\n                } else {\n                    this.gcode = commands[0].command\n                }\n            } else if(commands?.length > 1) {\n                let commands = this.helplist.filter((element) => element.commandLow.startsWith(check.toLowerCase()))\n                if (this.rows > 1) {\n                    this.gcode = this.gcode.replace(check, commands.reduce((acc, val) => {\n                        return strLongestEqual(acc, val.command)\n                    }, commands[0].command))\n                } else {\n                    this.gcode = commands.reduce((acc, val) => {\n                        return strLongestEqual(acc, val.command)\n                    }, commands[0].command)\n                }\n                if (commands && commands.length) {\n                    let output = ''\n                    commands.forEach(command => output += '<a class=\"command blue--text font-weight-bold\">'+command.command+'</a>: '+command.description+'<br />')\n\n                    this.$store.dispatch('server/addEvent', { message: output, type: 'autocomplete' })\n                }\n            }\n        }\n        this.$refs.gcodeCommandField.focus()\n    }\n\n    toggleFilter(filter: string) {\n        this.$store.dispatch('gui/updateConsoleFilter',  filter)\n    }\n\n    mounted() {\n        if (this.consoleDirection === 'shell') this.scrollToBottom()\n    }\n\n    scrollToBottom() {\n        this.$nextTick(() => {\n            if (this.$refs.miniConsoleScroll) {\n                const overlayscroll = this.$refs.miniConsoleScroll.osInstance()\n                overlayscroll?.scroll({ y: '100%' })\n            }\n        })\n    }\n\n    scrollToTop() {\n        this.$nextTick(() => {\n            if (this.$refs.miniConsoleScroll) {\n                const overlayscroll = this.$refs.miniConsoleScroll.osInstance()\n                overlayscroll?.scroll({ y: '0%' })\n            }\n        })\n    }\n}\n</script>\n"]}]}