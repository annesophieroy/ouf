{"remainingRequest":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/panels/HistoryStatisticsPanel.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/panels/HistoryStatisticsPanel.vue","mtime":1644874918000},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/babel-loader/lib/index.js","mtime":1645990067759},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/ts-loader/index.js","mtime":1645990068168},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1645990069130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7Q29tcG9uZW50LCBNaXhpbnN9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InCmltcG9ydCBCYXNlTWl4aW4gZnJvbSAnQC9jb21wb25lbnRzL21peGlucy9iYXNlJwppbXBvcnQgUGFuZWwgZnJvbSAnQC9jb21wb25lbnRzL3VpL1BhbmVsLnZ1ZScKaW1wb3J0IEhpc3RvcnlGaWxhbWVudFVzYWdlIGZyb20gJ0AvY29tcG9uZW50cy9jaGFydHMvSGlzdG9yeUZpbGFtZW50VXNhZ2UudnVlJwppbXBvcnQgSGlzdG9yeVByaW50dGltZUF2ZyBmcm9tICdAL2NvbXBvbmVudHMvY2hhcnRzL0hpc3RvcnlQcmludHRpbWVBdmcudnVlJwppbXBvcnQgSGlzdG9yeUFsbFByaW50U3RhdHVzIGZyb20gJ0AvY29tcG9uZW50cy9jaGFydHMvSGlzdG9yeUFsbFByaW50U3RhdHVzLnZ1ZScKQENvbXBvbmVudCh7CiAgICBjb21wb25lbnRzOiB7UGFuZWwsSGlzdG9yeUZpbGFtZW50VXNhZ2UsIEhpc3RvcnlQcmludHRpbWVBdmcsIEhpc3RvcnlBbGxQcmludFN0YXR1c30KfSkKZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGlzdG9yeVN0YXRpc3RpY3NQYW5lbCBleHRlbmRzIE1peGlucyhCYXNlTWl4aW4pIHsKICAgIGdldCB0b3RhbFByaW50VGltZSgpIHsKICAgICAgICByZXR1cm4gJ3RvdGFsX3ByaW50X3RpbWUnIGluIHRoaXMuJHN0b3JlLnN0YXRlLnNlcnZlci5oaXN0b3J5LmpvYl90b3RhbHMgPyB0aGlzLiRzdG9yZS5zdGF0ZS5zZXJ2ZXIuaGlzdG9yeS5qb2JfdG90YWxzLnRvdGFsX3ByaW50X3RpbWUgOiAwCiAgICB9CgogICAgZ2V0IGxvbmdlc3RQcmludFRpbWUoKSB7CiAgICAgICAgcmV0dXJuICdsb25nZXN0X3ByaW50JyBpbiB0aGlzLiRzdG9yZS5zdGF0ZS5zZXJ2ZXIuaGlzdG9yeS5qb2JfdG90YWxzID8gdGhpcy4kc3RvcmUuc3RhdGUuc2VydmVyLmhpc3Rvcnkuam9iX3RvdGFscy5sb25nZXN0X3ByaW50IDogMAogICAgfQoKICAgIGdldCBhdmdQcmludFRpbWUoKSB7CiAgICAgICAgaWYgKHRoaXMudG90YWxKb2JzQ291bnQgPiAwICYmIHRoaXMudG90YWxQcmludFRpbWUgPiAwKSByZXR1cm4gTWF0aC5yb3VuZCh0aGlzLnRvdGFsUHJpbnRUaW1lIC8gdGhpcy50b3RhbEpvYnNDb3VudCkKCiAgICAgICAgcmV0dXJuIDAKICAgIH0KCiAgICBnZXQgdG90YWxGaWxhbWVudFVzZWQoKSB7CiAgICAgICAgcmV0dXJuICd0b3RhbF9maWxhbWVudF91c2VkJyBpbiB0aGlzLiRzdG9yZS5zdGF0ZS5zZXJ2ZXIuaGlzdG9yeS5qb2JfdG90YWxzID8gdGhpcy4kc3RvcmUuc3RhdGUuc2VydmVyLmhpc3Rvcnkuam9iX3RvdGFscy50b3RhbF9maWxhbWVudF91c2VkIDogMAogICAgfQoKICAgIGdldCB0b3RhbEpvYnNDb3VudCgpIHsKICAgICAgICByZXR1cm4gJ3RvdGFsX2pvYnMnIGluIHRoaXMuJHN0b3JlLnN0YXRlLnNlcnZlci5oaXN0b3J5LmpvYl90b3RhbHMgPyB0aGlzLiRzdG9yZS5zdGF0ZS5zZXJ2ZXIuaGlzdG9yeS5qb2JfdG90YWxzLnRvdGFsX2pvYnMgOiAwCiAgICB9CgogICAgZ2V0IHRvZ2dsZUNoYXJ0ICgpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZ3VpLnZpZXcuaGlzdG9yeS50b2dnbGVDaGFydENvbDMKICAgIH0KCiAgICBzZXQgdG9nZ2xlQ2hhcnQobmV3VmFsKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2d1aS9zYXZlU2V0dGluZycsIHsgbmFtZTogJ3ZpZXcuaGlzdG9yeS50b2dnbGVDaGFydENvbDMnLCB2YWx1ZTogbmV3VmFsIH0pCiAgICB9CgogICAgZm9ybWF0UHJpbnRUaW1lKHRvdGFsU2Vjb25kczogbnVtYmVyKSB7CiAgICAgICAgaWYgKHRvdGFsU2Vjb25kcykgewogICAgICAgICAgICBsZXQgb3V0cHV0ID0gJycKCiAgICAgICAgICAgIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcih0b3RhbFNlY29uZHMgLyAzNjAwKQogICAgICAgICAgICB0b3RhbFNlY29uZHMgJT0gMzYwMAogICAgICAgICAgICBpZiAoaG91cnMpIG91dHB1dCArPSAnICcraG91cnMrJ2gnCgogICAgICAgICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcih0b3RhbFNlY29uZHMgLyA2MCkKICAgICAgICAgICAgaWYgKG1pbnV0ZXMpIG91dHB1dCArPSAnICcrbWludXRlcysnbScKCiAgICAgICAgICAgIGNvbnN0IHNlY29uZHMgPSB0b3RhbFNlY29uZHMgJSA2MAogICAgICAgICAgICBpZiAoc2Vjb25kcykgb3V0cHV0ICs9ICcgJytzZWNvbmRzLnRvRml4ZWQoMCkrJ3MnCgogICAgICAgICAgICByZXR1cm4gb3V0cHV0CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJy0tJwogICAgfQp9Cg=="},{"version":3,"sources":["HistoryStatisticsPanel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA","file":"HistoryStatisticsPanel.vue","sourceRoot":"src/components/panels","sourcesContent":["<template>\n    <panel\n        icon=\"mdi-chart-areaspline\"\n        :title=\"$t('History.Statistics')\"\n        card-class=\"history-statistics-panel\"\n        :collapsible=\"true\"\n    >\n        <v-card-text class=\"pa-0\">\n            <v-row align=\"center\">\n                <v-col class=\"col-12 col-sm-6 col-md-4\">\n                    <v-simple-table>\n                        <tbody>\n                        <tr>\n                            <td>{{ $t('History.TotalPrinttime') }}</td>\n                            <td class=\"text-right\">{{ formatPrintTime(totalPrintTime) }}</td>\n                        </tr>\n                        <tr>\n                            <td>{{ $t('History.LongestPrinttime') }}</td>\n                            <td class=\"text-right\">{{ formatPrintTime(longestPrintTime) }}</td>\n                        </tr>\n                        <tr>\n                            <td>{{ $t('History.AvgPrinttime') }}</td>\n                            <td class=\"text-right\">{{ formatPrintTime(avgPrintTime) }}</td>\n                        </tr>\n                        <tr>\n                            <td>{{ $t('History.TotalFilamentUsed') }}</td>\n                            <td class=\"text-right\">{{ Math.round(totalFilamentUsed / 100) / 10 }} m</td>\n                        </tr>\n                        <tr>\n                            <td>{{ $t('History.TotalJobs') }}</td>\n                            <td class=\"text-right\">{{ totalJobsCount }}</td>\n                        </tr>\n                        </tbody>\n                    </v-simple-table>\n                </v-col>\n                <v-col class=\"col-12 col-sm-6 col-md-4\">\n                    <history-all-print-status></history-all-print-status>\n                </v-col>\n                <v-col class=\"col-12 col-sm-12 col-md-4\">\n                    <history-filament-usage v-if=\"toggleChart === 'filament_usage'\"></history-filament-usage>\n                    <history-printtime-avg v-if=\"toggleChart === 'printtime_avg'\"></history-printtime-avg>\n                    <div class=\"text-center mt-3\">\n                        <v-btn-toggle v-model=\"toggleChart\" small mandatory>\n                            <v-btn small value=\"filament_usage\">\n                                {{ $t('History.FilamentUsage') }}\n                            </v-btn>\n                            <v-btn small value=\"printtime_avg\">\n                                {{ $t('History.PrinttimeAvg') }}\n                            </v-btn>\n                        </v-btn-toggle>\n                    </div>\n                </v-col>\n            </v-row>\n        </v-card-text>\n    </panel>\n</template>\n\n<script lang=\"ts\">\nimport {Component, Mixins} from 'vue-property-decorator'\nimport BaseMixin from '@/components/mixins/base'\nimport Panel from '@/components/ui/Panel.vue'\nimport HistoryFilamentUsage from '@/components/charts/HistoryFilamentUsage.vue'\nimport HistoryPrinttimeAvg from '@/components/charts/HistoryPrinttimeAvg.vue'\nimport HistoryAllPrintStatus from '@/components/charts/HistoryAllPrintStatus.vue'\n@Component({\n    components: {Panel,HistoryFilamentUsage, HistoryPrinttimeAvg, HistoryAllPrintStatus}\n})\nexport default class HistoryStatisticsPanel extends Mixins(BaseMixin) {\n    get totalPrintTime() {\n        return 'total_print_time' in this.$store.state.server.history.job_totals ? this.$store.state.server.history.job_totals.total_print_time : 0\n    }\n\n    get longestPrintTime() {\n        return 'longest_print' in this.$store.state.server.history.job_totals ? this.$store.state.server.history.job_totals.longest_print : 0\n    }\n\n    get avgPrintTime() {\n        if (this.totalJobsCount > 0 && this.totalPrintTime > 0) return Math.round(this.totalPrintTime / this.totalJobsCount)\n\n        return 0\n    }\n\n    get totalFilamentUsed() {\n        return 'total_filament_used' in this.$store.state.server.history.job_totals ? this.$store.state.server.history.job_totals.total_filament_used : 0\n    }\n\n    get totalJobsCount() {\n        return 'total_jobs' in this.$store.state.server.history.job_totals ? this.$store.state.server.history.job_totals.total_jobs : 0\n    }\n\n    get toggleChart () {\n        return this.$store.state.gui.view.history.toggleChartCol3\n    }\n\n    set toggleChart(newVal) {\n        this.$store.dispatch('gui/saveSetting', { name: 'view.history.toggleChartCol3', value: newVal })\n    }\n\n    formatPrintTime(totalSeconds: number) {\n        if (totalSeconds) {\n            let output = ''\n\n            const hours = Math.floor(totalSeconds / 3600)\n            totalSeconds %= 3600\n            if (hours) output += ' '+hours+'h'\n\n            const minutes = Math.floor(totalSeconds / 60)\n            if (minutes) output += ' '+minutes+'m'\n\n            const seconds = totalSeconds % 60\n            if (seconds) output += ' '+seconds.toFixed(0)+'s'\n\n            return output\n        }\n\n        return '--'\n    }\n}\n</script>\n"]}]}