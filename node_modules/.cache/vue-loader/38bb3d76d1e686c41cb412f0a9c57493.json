{"remainingRequest":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/inputs/ToolSlider.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/inputs/ToolSlider.vue","mtime":1644874918000},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/babel-loader/lib/index.js","mtime":1645990067759},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/ts-loader/index.js","mtime":1645990068168},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1645990069130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgppbXBvcnQge0NvbXBvbmVudCwgTWl4aW5zLCBQcm9wLCBXYXRjaH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcicKaW1wb3J0IEJhc2VNaXhpbiBmcm9tICdAL2NvbXBvbmVudHMvbWl4aW5zL2Jhc2UnCmltcG9ydCB7RGVib3VuY2V9IGZyb20gJ3Z1ZS1kZWJvdW5jZS1kZWNvcmF0b3InCgpAQ29tcG9uZW50CmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvb2xTbGlkZXIgZXh0ZW5kcyBNaXhpbnMoQmFzZU1peGluKSB7CiAgICBwcml2YXRlIHRpbWVvdXQ6IG51bWJlciB8IHVuZGVmaW5lZAogICAgcHJpdmF0ZSBpc0xvY2tlZCA9IGZhbHNlCiAgICB2YWx1ZSA9IDAKICAgIHN0YXJ0VmFsdWUgPSAwCiAgICBwcm9jZXNzZWRNYXggPSAxMDAKICAgIGR5bmFtaWNTdGVwID0gNTAKCiAgICBAUHJvcCh7IHR5cGU6IE51bWJlciwgcmVxdWlyZWQ6IHRydWUgfSkgcmVhZG9ubHkgdGFyZ2V0ITogbnVtYmVyCiAgICBAUHJvcCh7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSkgcmVhZG9ubHkgY29tbWFuZCE6IHN0cmluZwogICAgQFByb3AoeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcnIH0pIHJlYWRvbmx5IGF0dHJpYnV0ZU5hbWUhOiBzdHJpbmcKICAgIEBQcm9wKHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnJyB9KSByZWFkb25seSBsYWJlbCE6IHN0cmluZwogICAgQFByb3AoeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcnIH0pIHJlYWRvbmx5IGljb24hOiBzdHJpbmcgCiAgICBAUHJvcCh7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJyUnIH0pIHJlYWRvbmx5IHVuaXQhOiBzdHJpbmcKICAgIEBQcm9wKHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAxIH0pIHJlYWRvbmx5IGF0dHJpYnV0ZVNjYWxlITogbnVtYmVyCiAgICBAUHJvcCh7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9KSByZWFkb25seSBtaW4hOiBudW1iZXIKICAgIEBQcm9wKHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAxMDAgfSkgcmVhZG9ubHkgbWF4ITogbnVtYmVyCiAgICBAUHJvcCh7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IGZhbHNlIH0pIHJlYWRvbmx5IGR5bmFtaWNSYW5nZSE6IGJvb2xlYW4KICAgIEBQcm9wKHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAxMDAgfSkgcmVhZG9ubHkgZGVmYXVsdFZhbHVlITogbnVtYmVyCiAgICBAUHJvcCh7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMTAwIH0pIHJlYWRvbmx5IHN0ZXAhOiBudW1iZXIKICAgIEBQcm9wKHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAxIH0pIHJlYWRvbmx5IG11bHRpITogbnVtYmVyCgogICAgY3JlYXRlZCgpIHsKICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy50YXJnZXQgKiB0aGlzLm11bHRpCiAgICAgICAgdGhpcy5zdGFydFZhbHVlID0gdGhpcy50YXJnZXQgKiB0aGlzLm11bHRpCiAgICAgICAgdGhpcy5keW5hbWljU3RlcCA9IE1hdGguZmxvb3IoKHRoaXMubWF4IC0gdGhpcy5taW4pIC8gMikKCiAgICAgICAgaWYgKHRoaXMudmFsdWUgPj0gdGhpcy5wcm9jZXNzZWRNYXgpIHsKICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRNYXggPSAoTWF0aC5jZWlsKHRoaXMudmFsdWUgLyB0aGlzLmR5bmFtaWNTdGVwKSArIDEpICogdGhpcy5keW5hbWljU3RlcAogICAgICAgIH0KICAgIH0KCiAgICBAV2F0Y2goJ2xvY2tTbGlkZXJzJywge2ltbWVkaWF0ZTogdHJ1ZX0pCiAgICBsb2NrU2xpZGVyc0NoYW5nZWQoKXsKICAgICAgICB0aGlzLmlzTG9ja2VkID0gdGhpcy5sb2NrU2xpZGVycyAmJiB0aGlzLmlzVG91Y2hEZXZpY2UKICAgIH0KCiAgICBzdGFydExvY2tUaW1lcigpIHsKICAgICAgICBsZXQgdCA9IHRoaXMubG9ja1NsaWRlcnNEZWxheQogICAgICAgIGlmICghdGhpcy5pc1RvdWNoRGV2aWNlIHx8ICF0aGlzLmxvY2tTbGlkZXJzIHx8ICh0IDw9IDApKSByZXR1cm4KICAgICAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHRoaXMuaXNMb2NrZWQgPSB0cnVlLCB0ICogMTAwMCkKICAgIH0KCiAgICByZXNldExvY2tUaW1lcigpIHsKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KQogICAgfQoKICAgIGdldCBsb2NrU2xpZGVycygpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZ3VpLnVpU2V0dGluZ3MubG9ja1NsaWRlcnNPblRvdWNoRGV2aWNlcwogICAgfQoKICAgIGdldCBsb2NrU2xpZGVyc0RlbGF5KCkgewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5ndWkudWlTZXR0aW5ncy5sb2NrU2xpZGVyc0RlbGF5CiAgICB9CgogICAgZ2V0IGNvbG9yQmFyKCkgewogICAgICAgIHJldHVybiB0aGlzLm1heCA8IHRoaXMudmFsdWUgPyAnd2FybmluZycgOiAncHJpbWFyeScKICAgIH0KCiAgICBARGVib3VuY2UoMjUwKQogICAgY2hhbmdlU2xpZGVyKCkgewogICAgICAgIHRoaXMuc2VuZENtZCgpCgogICAgICAgIGlmICghdGhpcy5keW5hbWljUmFuZ2UpIHJldHVybgogICAgICAgIGlmICh0aGlzLnZhbHVlID49IHRoaXMucHJvY2Vzc2VkTWF4KSB7CiAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkTWF4ID0gdGhpcy52YWx1ZSArIHRoaXMuZHluYW1pY1N0ZXAKICAgICAgICB9CiAgICB9CgogICAgQFdhdGNoKCd0YXJnZXQnLCB7IGltbWVkaWF0ZTogdHJ1ZSB9KQogICAgdGFyZ2V0Q2hhbmdlZChuZXdWYWw6IG51bWJlcikgewogICAgICAgIHRoaXMudmFsdWUgPSBNYXRoLnJvdW5kKG5ld1ZhbCAqIHRoaXMubXVsdGkpCgogICAgICAgIGlmICghdGhpcy5keW5hbWljUmFuZ2UpIHJldHVybgogICAgICAgIGlmICh0aGlzLnZhbHVlID49IHRoaXMucHJvY2Vzc2VkTWF4KSB7CiAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkTWF4ID0gdGhpcy52YWx1ZSArIHRoaXMuZHluYW1pY1N0ZXAKICAgICAgICB9CiAgICB9CgogICAgQFdhdGNoKCdtYXgnLCB7IGltbWVkaWF0ZTogdHJ1ZSB9KQogICAgbWF4Q2hhbmdlZChuZXdWYWw6IG51bWJlcikgewogICAgICAgIHRoaXMucHJvY2Vzc2VkTWF4ID0gbmV3VmFsID4gdGhpcy52YWx1ZSA/IG5ld1ZhbCA6IE1hdGguY2VpbCh0aGlzLnZhbHVlIC8gdGhpcy5keW5hbWljU3RlcCkgKiB0aGlzLmR5bmFtaWNTdGVwCiAgICB9CgogICAgcmVzZXRTbGlkZXIoKSB7CiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuZGVmYXVsdFZhbHVlCiAgICAgICAgdGhpcy5wcm9jZXNzZWRNYXggPSB0aGlzLm1heAogICAgICAgIGlmICh0aGlzLnZhbHVlID49IHRoaXMucHJvY2Vzc2VkTWF4KSB7CiAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkTWF4ID0gKE1hdGguY2VpbCh0aGlzLnZhbHVlIC8gdGhpcy5keW5hbWljU3RlcCkgKyAxKSAqIHRoaXMuZHluYW1pY1N0ZXAKICAgICAgICB9CgogICAgICAgIHRoaXMuc2VuZENtZCgpCiAgICB9CgogICAgc2VuZENtZCgpIHsKICAgICAgICBjb25zdCBnY29kZSA9IHRoaXMuY29tbWFuZCArICcgJyArIHRoaXMuYXR0cmlidXRlTmFtZSArIChNYXRoLm1heCgxLCB0aGlzLnZhbHVlKSAqIHRoaXMuYXR0cmlidXRlU2NhbGUpLnRvRml4ZWQoMCkKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2VydmVyL2FkZEV2ZW50Jywge21lc3NhZ2U6IGdjb2RlLCB0eXBlOiAnY29tbWFuZCd9KQogICAgICAgIHRoaXMuJHNvY2tldC5lbWl0KCdwcmludGVyLmdjb2RlLnNjcmlwdCcsIHtzY3JpcHQ6IGdjb2RlfSkKCiAgICAgICAgdGhpcy5zdGFydExvY2tUaW1lcigpCiAgICB9CgogICAgZGVjcmVtZW50KCkgewogICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlID4gdGhpcy5taW4gPyBNYXRoLnJvdW5kKHRoaXMudmFsdWUgLSB0aGlzLnN0ZXApIDogdGhpcy5taW4KICAgICAgICB0aGlzLnNlbmRDbWQoKQogICAgfQoKICAgIGluY3JlbWVudCgpIHsKICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZSA8IHRoaXMucHJvY2Vzc2VkTWF4IHx8IHRoaXMuZHluYW1pY1JhbmdlID8gTWF0aC5yb3VuZCh0aGlzLnZhbHVlICsgdGhpcy5zdGVwKSA6IHRoaXMucHJvY2Vzc2VkTWF4CiAgICAgICAgdGhpcy5zZW5kQ21kKCkKICAgIH0KfQo="},{"version":3,"sources":["ToolSlider.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"ToolSlider.vue","sourceRoot":"src/components/inputs","sourcesContent":["<style scoped>\n    ._tool-slider-subheader {\n        height: auto;\n    }\n</style>\n\n<template>\n    <v-container class=\"px-0 py-2\">\n        <v-row>\n            <v-col class=\"pb-1 pt-3\">\n                <v-subheader class=\"_tool-slider-subheader\">\n                    <v-btn\n                        v-if=\"lockSliders && isTouchDevice\"\n                        @click=\"isLocked = !isLocked\"\n                        plain\n                        small\n                        icon\n                    >\n                        <v-icon small :color=\"(isLocked ? 'red' : '')\">\n                            {{ isLocked ? 'mdi-lock-outline' : 'mdi-lock-open-variant-outline' }}\n                        </v-icon>\n                    </v-btn>\n                    <v-icon small :class=\"'mr-2'\">\n                        {{ icon }}\n                    </v-icon>\n                    <span>{{ label }}</span>\n                    <v-btn\n                        v-if=\"value !== defaultValue\"\n                        class=\"ml-2\"\n                        x-small\n                        icon\n                        :disabled=\"isLocked\"\n                        @click=\"resetSlider\"\n                    >\n                        <v-icon>mdi-restart</v-icon>\n                    </v-btn>\n                    <v-spacer></v-spacer>\n                    <span class=\"font-weight-bold\">\n                        {{ value }} {{ unit }}\n                    </span>\n                </v-subheader>\n                <v-card-text class=\"py-0\">\n                    <v-slider\n                        v-model=\"value\"\n                        v-touch=\"{start: resetLockTimer}\"\n                        :disabled=\"isLocked\"\n                        :min=\"min\"\n                        :max=\"processedMax\"\n                        :color=\"colorBar\"\n                        @change=\"changeSlider\"\n                        hide-details>\n\n                        <template v-slot:prepend>\n                            <v-icon @click=\"decrement\" :disabled=\"isLocked\">mdi-minus</v-icon>\n                        </template>\n\n                        <template v-slot:append>\n                            <v-icon @click=\"increment\" :disabled=\"isLocked\">mdi-plus</v-icon>\n                        </template>\n                    </v-slider>\n                </v-card-text>\n            </v-col>\n        </v-row>\n    </v-container>\n</template>\n\n\n<script lang=\"ts\">\nimport {Component, Mixins, Prop, Watch} from 'vue-property-decorator'\nimport BaseMixin from '@/components/mixins/base'\nimport {Debounce} from 'vue-debounce-decorator'\n\n@Component\nexport default class ToolSlider extends Mixins(BaseMixin) {\n    private timeout: number | undefined\n    private isLocked = false\n    value = 0\n    startValue = 0\n    processedMax = 100\n    dynamicStep = 50\n\n    @Prop({ type: Number, required: true }) readonly target!: number\n    @Prop({ type: String, required: true }) readonly command!: string\n    @Prop({ type: String, default: '' }) readonly attributeName!: string\n    @Prop({ type: String, default: '' }) readonly label!: string\n    @Prop({ type: String, default: '' }) readonly icon!: string \n    @Prop({ type: String, default: '%' }) readonly unit!: string\n    @Prop({ type: Number, default: 1 }) readonly attributeScale!: number\n    @Prop({ type: Number, default: 0 }) readonly min!: number\n    @Prop({ type: Number, default: 100 }) readonly max!: number\n    @Prop({ type: Boolean, default: false }) readonly dynamicRange!: boolean\n    @Prop({ type: Number, default: 100 }) readonly defaultValue!: number\n    @Prop({ type: Number, default: 100 }) readonly step!: number\n    @Prop({ type: Number, default: 1 }) readonly multi!: number\n\n    created() {\n        this.value = this.target * this.multi\n        this.startValue = this.target * this.multi\n        this.dynamicStep = Math.floor((this.max - this.min) / 2)\n\n        if (this.value >= this.processedMax) {\n            this.processedMax = (Math.ceil(this.value / this.dynamicStep) + 1) * this.dynamicStep\n        }\n    }\n\n    @Watch('lockSliders', {immediate: true})\n    lockSlidersChanged(){\n        this.isLocked = this.lockSliders && this.isTouchDevice\n    }\n\n    startLockTimer() {\n        let t = this.lockSlidersDelay\n        if (!this.isTouchDevice || !this.lockSliders || (t <= 0)) return\n        this.timeout = setTimeout(() => this.isLocked = true, t * 1000)\n    }\n\n    resetLockTimer() {\n        clearTimeout(this.timeout)\n    }\n\n    get lockSliders() {\n        return this.$store.state.gui.uiSettings.lockSlidersOnTouchDevices\n    }\n\n    get lockSlidersDelay() {\n        return this.$store.state.gui.uiSettings.lockSlidersDelay\n    }\n\n    get colorBar() {\n        return this.max < this.value ? 'warning' : 'primary'\n    }\n\n    @Debounce(250)\n    changeSlider() {\n        this.sendCmd()\n\n        if (!this.dynamicRange) return\n        if (this.value >= this.processedMax) {\n            this.processedMax = this.value + this.dynamicStep\n        }\n    }\n\n    @Watch('target', { immediate: true })\n    targetChanged(newVal: number) {\n        this.value = Math.round(newVal * this.multi)\n\n        if (!this.dynamicRange) return\n        if (this.value >= this.processedMax) {\n            this.processedMax = this.value + this.dynamicStep\n        }\n    }\n\n    @Watch('max', { immediate: true })\n    maxChanged(newVal: number) {\n        this.processedMax = newVal > this.value ? newVal : Math.ceil(this.value / this.dynamicStep) * this.dynamicStep\n    }\n\n    resetSlider() {\n        this.value = this.defaultValue\n        this.processedMax = this.max\n        if (this.value >= this.processedMax) {\n            this.processedMax = (Math.ceil(this.value / this.dynamicStep) + 1) * this.dynamicStep\n        }\n\n        this.sendCmd()\n    }\n\n    sendCmd() {\n        const gcode = this.command + ' ' + this.attributeName + (Math.max(1, this.value) * this.attributeScale).toFixed(0)\n        this.$store.dispatch('server/addEvent', {message: gcode, type: 'command'})\n        this.$socket.emit('printer.gcode.script', {script: gcode})\n\n        this.startLockTimer()\n    }\n\n    decrement() {\n        this.value = this.value > this.min ? Math.round(this.value - this.step) : this.min\n        this.sendCmd()\n    }\n\n    increment() {\n        this.value = this.value < this.processedMax || this.dynamicRange ? Math.round(this.value + this.step) : this.processedMax\n        this.sendCmd()\n    }\n}\n</script>\n"]}]}