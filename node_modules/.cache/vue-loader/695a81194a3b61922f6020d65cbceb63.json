{"remainingRequest":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/panels/Machine/EndstopPanel.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/src/components/panels/Machine/EndstopPanel.vue","mtime":1644874918000},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/babel-loader/lib/index.js","mtime":1645990067759},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/ts-loader/index.js","mtime":1645990068168},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/cache-loader/dist/cjs.js","mtime":1645990064605},{"path":"/Users/anne-sophieroy/Downloads/Mainsail/mainsail-maintenance/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1645990069130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7Q29tcG9uZW50LCBNaXhpbnN9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InCmltcG9ydCBCYXNlTWl4aW4gZnJvbSAnLi4vLi4vbWl4aW5zL2Jhc2UnCmltcG9ydCBQYW5lbCBmcm9tICdAL2NvbXBvbmVudHMvdWkvUGFuZWwudnVlJwpAQ29tcG9uZW50KHsKICAgIGNvbXBvbmVudHM6IHtQYW5lbH0KfSkKZXhwb3J0IGRlZmF1bHQgY2xhc3MgRW5kc3RvcFBhbmVsIGV4dGVuZHMgTWl4aW5zKEJhc2VNaXhpbikgewogICAgcHVibGljIHNvcnRFbmRzdG9wczogYW55ID0ge30KCiAgICBnZXQgZW5kc3RvcHMoKSB7CiAgICAgICAgY29uc3QgZW5kc3RvcHMgPSB0aGlzLiRzdG9yZS5zdGF0ZS5wcmludGVyLmVuZHN0b3BzID8/IHt9CgogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhlbmRzdG9wcykuc29ydCgpLnJlZHVjZSgKICAgICAgICAgICAgKG9iajogYW55LCBrZXk6IHN0cmluZykgPT4gewogICAgICAgICAgICAgICAgb2JqW2tleV0gPSBlbmRzdG9wc1trZXldCiAgICAgICAgICAgICAgICByZXR1cm4gb2JqCiAgICAgICAgICAgIH0sIHt9CiAgICAgICAgKQogICAgfQoKICAgIGdldCBleGlzdFByb2JlICgpIHsKICAgICAgICByZXR1cm4gKCdwcm9iZScgaW4gdGhpcy4kc3RvcmUuc3RhdGUucHJpbnRlci5jb25maWdmaWxlLnNldHRpbmdzKQogICAgfQoKICAgIGdldCBwcm9iZSAoKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgICAncHJvYmUnIGluIHRoaXMuJHN0b3JlLnN0YXRlLnByaW50ZXIgJiYKICAgICAgICAgICAgJ2xhc3RfcXVlcnknIGluIHRoaXMuJHN0b3JlLnN0YXRlLnByaW50ZXIucHJvYmUKICAgICAgICApIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5wcmludGVyLnByb2JlLmxhc3RfcXVlcnkKCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgc3luY0VuZHN0b3BzKCkgewogICAgICAgIHRoaXMuJHNvY2tldC5lbWl0KCdwcmludGVyLnF1ZXJ5X2VuZHN0b3BzLnN0YXR1cycsIHsgfSwgeyBhY3Rpb246ICdwcmludGVyL2dldEVuZHN0b3BTdGF0dXMnLCBsb2FkaW5nOiAncXVlcnlFbmRzdG9wcycgfSkKICAgICAgICBpZiAodGhpcy5leGlzdFByb2JlKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzZXJ2ZXIvYWRkRXZlbnQnLCB7IG1lc3NhZ2U6ICdRVUVSWV9QUk9CRScsIHR5cGU6ICdjb21tYW5kJyB9KQogICAgICAgICAgICB0aGlzLiRzb2NrZXQuZW1pdCgncHJpbnRlci5nY29kZS5zY3JpcHQnLCB7IHNjcmlwdDogJ1FVRVJZX1BST0JFJyB9KQogICAgICAgIH0KICAgIH0KfQoKLyogICAgaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICd2dWV4JwoKICAgIGV4cG9ydCBkZWZhdWx0IHsKICAgICAgICBjcmVhdGVkKCkgewogICAgICAgICAgICB0aGlzLmdldEVuZHN0b3BzKCk7CiAgICAgICAgfSwKICAgICAgICBtZXRob2RzOiB7CiAgICAgICAgICAgICwKICAgICAgICAgICAgZ2V0RW5kc3RvcHMoKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNvcnRFbmRzdG9wcyA9IHt9OwoKICAgICAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5lbmRzdG9wcyk7CiAgICAgICAgICAgICAgICBrZXlzLnNvcnQoKTsKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBsZXQgayA9IGtleXNbaV07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zb3J0RW5kc3RvcHNba10gPSB0aGlzLmVuZHN0b3BzW2tdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB3YXRjaDogewogICAgICAgICAgICBlbmRzdG9wczogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLmdldEVuZHN0b3BzKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Ki8K"},{"version":3,"sources":["EndstopPanel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EndstopPanel.vue","sourceRoot":"src/components/panels/Machine","sourcesContent":["<template>\n    <panel :title=\"$t('Machine.EndstopPanel.Endstops')\" icon=\"mdi-arrow-expand-vertical\" card-class=\"machine-endstop-panel\" :collapsible=\"true\">\n        <v-card-text class=\"pb-0\">\n            <v-container px-0 py-0>\n                <template v-if=\"Object.keys(endstops).length\">\n                    <v-row v-for=\"key of Object.keys(endstops)\" v-bind:key=\"key\">\n                        <v-col class=\"py-1\">\n                            <label class=\"mt-1 d-inline-block\">{{ $t('Machine.EndstopPanel.Endstop')}} <b>{{ key.toUpperCase() }}</b></label>\n                            <v-chip small label class=\"float-right\" :color=\"endstops[key] === 'open' ? 'green' : 'red' \" text-color=\"white\">\n                                <template v-if=\"endstops[key] === 'open'\">\n                                    {{ $t('Machine.EndstopPanel.open')}}\n                                </template>\n                                <template v-else>\n                                    {{ $t('Machine.EndstopPanel.TRIGGERED')}}\n                                </template>\n                            </v-chip>\n                        </v-col>\n                    </v-row>\n                    <v-row v-if=\"existProbe\">\n                        <v-col class=\"py-1\">\n                            <label class=\"mt-1 d-inline-block\">Probe</label>\n                            <v-chip small label class=\"float-right\" :color=\"probe ? 'red' : 'green' \" text-color=\"white\">\n                            <template v-if=\"probe\">\n                                {{ $t('Machine.EndstopPanel.TRIGGERED')}}\n                            </template>\n                            <template v-else>\n                                {{ $t('Machine.EndstopPanel.open')}}\n                            </template>\n                            </v-chip>\n                        </v-col>\n                    </v-row>\n                </template>\n                <template v-else>\n                    <v-row>\n                        <v-col>\n                            <p>{{ $t('Machine.EndstopPanel.EndstopInfo')}}</p>\n                        </v-col>\n                    </v-row>\n                </template>\n            </v-container>\n        </v-card-text>\n        <v-card-actions class=\"pt-3\">\n            <v-spacer></v-spacer>\n            <v-btn icon @click=\"syncEndstops\" :loading=\"loadings.includes('queryEndstops')\">\n                <v-icon>mdi-sync</v-icon>\n            </v-btn>\n        </v-card-actions>\n    </panel>\n</template>\n\n<script lang=\"ts\">\n\nimport {Component, Mixins} from 'vue-property-decorator'\nimport BaseMixin from '../../mixins/base'\nimport Panel from '@/components/ui/Panel.vue'\n@Component({\n    components: {Panel}\n})\nexport default class EndstopPanel extends Mixins(BaseMixin) {\n    public sortEndstops: any = {}\n\n    get endstops() {\n        const endstops = this.$store.state.printer.endstops ?? {}\n\n        return Object.keys(endstops).sort().reduce(\n            (obj: any, key: string) => {\n                obj[key] = endstops[key]\n                return obj\n            }, {}\n        )\n    }\n\n    get existProbe () {\n        return ('probe' in this.$store.state.printer.configfile.settings)\n    }\n\n    get probe () {\n        if (\n            'probe' in this.$store.state.printer &&\n            'last_query' in this.$store.state.printer.probe\n        ) return this.$store.state.printer.probe.last_query\n\n        return false\n    }\n\n    syncEndstops() {\n        this.$socket.emit('printer.query_endstops.status', { }, { action: 'printer/getEndstopStatus', loading: 'queryEndstops' })\n        if (this.existProbe) {\n            this.$store.dispatch('server/addEvent', { message: 'QUERY_PROBE', type: 'command' })\n            this.$socket.emit('printer.gcode.script', { script: 'QUERY_PROBE' })\n        }\n    }\n}\n\n/*    import { mapState } from 'vuex'\n\n    export default {\n        created() {\n            this.getEndstops();\n        },\n        methods: {\n            ,\n            getEndstops() {\n                this.sortEndstops = {};\n\n                let keys = Object.keys(this.endstops);\n                keys.sort();\n\n                for (let i = 0; i < keys.length; i++) {\n                    let k = keys[i];\n                    this.sortEndstops[k] = this.endstops[k];\n                }\n            }\n        },\n        watch: {\n            endstops: function() {\n                this.getEndstops();\n            }\n        }\n    }*/\n</script>"]}]}